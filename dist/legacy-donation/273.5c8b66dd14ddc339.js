"use strict";(self.webpackChunklegacy_donation=self.webpackChunklegacy_donation||[]).push([[273],{6273:(M,c,r)=>{r.r(c),r.d(c,{AdminComponent:()=>y});var l=r(177),d=r(4341),e=r(4438),m=r(3366),p=r(6544);const u=(s,i,t)=>({"bg-yellow-100 text-yellow-800":s,"bg-blue-100 text-blue-800":i,"bg-green-100 text-green-800":t});function g(s,i){1&s&&(e.qSk(),e.nrm(0,"path",18))}function _(s,i){if(1&s&&(e.j41(0,"div",19),e.EFF(1),e.k0s()),2&s){const t=e.XpG(2);e.R7$(),e.JRh(t.passwordError)}}function h(s,i){if(1&s){const t=e.RV6();e.j41(0,"div",4)(1,"h2",5),e.EFF(2,"Admin Access"),e.k0s(),e.j41(3,"p",6),e.EFF(4,"Enter admin password to access the dashboard"),e.k0s(),e.j41(5,"div",7)(6,"div")(7,"label",8),e.EFF(8,"Admin Password"),e.k0s(),e.j41(9,"div",9)(10,"input",10),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG();return e.DH7(a.adminPassword,o)||(a.adminPassword=o),e.Njj(o)}),e.k0s(),e.j41(11,"button",11),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.togglePasswordVisibility())}),e.qSk(),e.j41(12,"svg",12),e.nrm(13,"path",13)(14,"path",14),e.DNE(15,g,1,0,"path",15),e.k0s()()()(),e.DNE(16,_,2,1,"div",16),e.joV(),e.j41(17,"button",17),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.checkAdminPassword())}),e.EFF(18),e.k0s()()()}if(2&s){const t=e.XpG();e.R7$(10),e.Y8G("type",t.showPassword?"text":"password"),e.R50("ngModel",t.adminPassword),e.R7$(),e.Y8G("title",t.showPassword?"Hide password":"Show password"),e.R7$(),e.AVh("line-through",t.showPassword),e.R7$(3),e.Y8G("ngIf",t.showPassword),e.R7$(),e.Y8G("ngIf",t.passwordError),e.R7$(),e.Y8G("disabled",t.isAdmin),e.R7$(),e.SpI(" ",t.isAdmin?"Access Granted":"Access Admin Panel"," ")}}function x(s,i){1&s&&(e.j41(0,"div",31),e.qSk(),e.j41(1,"svg",32),e.nrm(2,"circle",33)(3,"path",34),e.k0s(),e.joV(),e.j41(4,"p",35),e.EFF(5,"Loading messages..."),e.k0s()())}function w(s,i){if(1&s){const t=e.RV6();e.j41(0,"div",36)(1,"div",37)(2,"p",38),e.EFF(3),e.k0s(),e.j41(4,"button",39),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.loadMessages())}),e.EFF(5," Try Again "),e.k0s()()()}if(2&s){const t=e.XpG(2);e.R7$(3),e.JRh(t.errorMessage)}}function f(s,i){if(1&s){const t=e.RV6();e.j41(0,"tr",46)(1,"td",47),e.EFF(2),e.k0s(),e.j41(3,"td",48),e.EFF(4),e.k0s(),e.j41(5,"td",49),e.EFF(6),e.k0s(),e.j41(7,"td",50),e.EFF(8),e.k0s(),e.j41(9,"td",51)(10,"span",52),e.EFF(11),e.k0s()(),e.j41(12,"td",49),e.EFF(13),e.k0s(),e.j41(14,"td",53)(15,"button",54),e.bIt("click",function(){const o=e.eBV(t).$implicit,a=e.XpG(3);return e.Njj(a.viewMessage(o))}),e.EFF(16," View "),e.k0s(),e.j41(17,"select",55),e.bIt("change",function(o){const a=e.eBV(t).$implicit,E=e.XpG(3);return e.Njj(E.updateStatus(a,o))}),e.j41(18,"option",56),e.EFF(19,"New"),e.k0s(),e.j41(20,"option",57),e.EFF(21,"Read"),e.k0s(),e.j41(22,"option",58),e.EFF(23,"Responded"),e.k0s()()()()}if(2&s){const t=i.$implicit,n=e.XpG(3);e.R7$(2),e.JRh(t.id),e.R7$(2),e.JRh(t.name),e.R7$(2),e.JRh(t.email),e.R7$(2),e.JRh(t.subject),e.R7$(2),e.Y8G("ngClass",e.sMw(10,u,"new"===t.status,"read"===t.status,"responded"===t.status)),e.R7$(),e.SpI(" ",t.status," "),e.R7$(2),e.SpI(" ",n.formatDate(t.created_at)," "),e.R7$(5),e.Y8G("selected","new"===t.status),e.R7$(2),e.Y8G("selected","read"===t.status),e.R7$(2),e.Y8G("selected","responded"===t.status)}}function v(s,i){1&s&&(e.j41(0,"div",31),e.qSk(),e.j41(1,"svg",59),e.nrm(2,"path",60),e.k0s(),e.joV(),e.j41(3,"h3",61),e.EFF(4,"No messages"),e.k0s(),e.j41(5,"p",62),e.EFF(6,"No contact messages have been received yet."),e.k0s()())}function k(s,i){if(1&s&&(e.j41(0,"div",40)(1,"table",41)(2,"thead",42)(3,"tr")(4,"th",43),e.EFF(5,"ID"),e.k0s(),e.j41(6,"th",43),e.EFF(7,"Name"),e.k0s(),e.j41(8,"th",43),e.EFF(9,"Email"),e.k0s(),e.j41(10,"th",43),e.EFF(11,"Subject"),e.k0s(),e.j41(12,"th",43),e.EFF(13,"Status"),e.k0s(),e.j41(14,"th",43),e.EFF(15,"Date"),e.k0s(),e.j41(16,"th",43),e.EFF(17,"Actions"),e.k0s()()(),e.j41(18,"tbody",44),e.DNE(19,f,24,14,"tr",45),e.k0s()(),e.DNE(20,v,7,0,"div",27),e.k0s()),2&s){const t=e.XpG(2);e.R7$(19),e.Y8G("ngForOf",t.messages),e.R7$(),e.Y8G("ngIf",0===t.messages.length)}}function b(s,i){if(1&s&&(e.j41(0,"div")(1,"label",71),e.EFF(2,"Phone"),e.k0s(),e.j41(3,"p",72),e.EFF(4),e.k0s()()),2&s){const t=e.XpG(3);e.R7$(4),e.JRh(t.selectedMessage.phone)}}function j(s,i){if(1&s){const t=e.RV6();e.j41(0,"div",63),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.closeModal())}),e.j41(1,"div",64),e.bIt("click",function(o){return e.eBV(t),e.Njj(o.stopPropagation())}),e.j41(2,"div",65)(3,"div",66)(4,"h3",67),e.EFF(5,"Message Details"),e.k0s(),e.j41(6,"button",68),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.closeModal())}),e.qSk(),e.j41(7,"svg",69),e.nrm(8,"path",70),e.k0s()()(),e.joV(),e.j41(9,"div",7)(10,"div")(11,"label",71),e.EFF(12,"From"),e.k0s(),e.j41(13,"p",72),e.EFF(14),e.k0s()(),e.DNE(15,b,5,1,"div",3),e.j41(16,"div")(17,"label",71),e.EFF(18,"Subject"),e.k0s(),e.j41(19,"p",72),e.EFF(20),e.k0s()(),e.j41(21,"div")(22,"label",71),e.EFF(23,"Message"),e.k0s(),e.j41(24,"div",73)(25,"p",74),e.EFF(26),e.k0s()()(),e.j41(27,"div")(28,"label",71),e.EFF(29,"Status"),e.k0s(),e.j41(30,"p",72),e.EFF(31),e.k0s()(),e.j41(32,"div")(33,"label",71),e.EFF(34,"Received"),e.k0s(),e.j41(35,"p",72),e.EFF(36),e.k0s()()()()()()}if(2&s){const t=e.XpG(2);e.R7$(14),e.Lme("",t.selectedMessage.name," (",t.selectedMessage.email,")"),e.R7$(),e.Y8G("ngIf",t.selectedMessage.phone),e.R7$(5),e.JRh(t.selectedMessage.subject),e.R7$(6),e.JRh(t.selectedMessage.message),e.R7$(5),e.JRh(t.selectedMessage.status),e.R7$(5),e.JRh(t.formatDate(t.selectedMessage.created_at))}}function F(s,i){if(1&s&&(e.j41(0,"div")(1,"div",20)(2,"h1",21),e.EFF(3,"Admin Dashboard"),e.k0s(),e.j41(4,"p",22),e.EFF(5,"Manage contact messages and system administration"),e.k0s()(),e.j41(6,"div",23)(7,"div",24)(8,"h2",25),e.EFF(9,"Contact Messages"),e.k0s(),e.j41(10,"p",26),e.EFF(11,"View and manage user inquiries"),e.k0s()(),e.DNE(12,x,6,0,"div",27)(13,w,6,1,"div",28)(14,k,21,2,"div",29),e.k0s(),e.DNE(15,j,37,7,"div",30),e.k0s()),2&s){const t=e.XpG();e.R7$(12),e.Y8G("ngIf",t.isLoading),e.R7$(),e.Y8G("ngIf",t.errorMessage),e.R7$(),e.Y8G("ngIf",!t.isLoading&&!t.errorMessage),e.R7$(),e.Y8G("ngIf",t.selectedMessage)}}let y=(()=>{class s{constructor(t,n){this.apiService=t,this.router=n,this.messages=[],this.selectedMessage=null,this.isLoading=!0,this.errorMessage="",this.isAdmin=!1,this.adminPassword="",this.passwordError="",this.showPassword=!1}ngOnInit(){const t=this.apiService.getCurrentUser();t&&"admin"===t.role?(this.isAdmin=!0,this.loadMessages()):this.isAdmin=!1}loadMessages(){this.isLoading=!0,this.errorMessage="",fetch("https://kilnenterprise.com/Donations/contact.php",{method:"GET",headers:{"Content-Type":"application/json"}}).then(t=>{if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);return t.json()}).then(t=>{this.isLoading=!1,t.success&&t.data?this.messages=t.data:this.errorMessage=t.error||"Failed to load messages"}).catch(t=>{this.loadDemoData()})}loadDemoData(){this.isLoading=!1,this.messages=[{id:1,name:"John Doe",email:"john.doe@email.com",phone:"+1234567890",subject:"Question about donation process",message:"Hi, I would like to know more about how the donation process works. Can you provide more details?",status:"new",created_at:(new Date).toISOString()},{id:2,name:"Jane Smith",email:"jane.smith@email.com",phone:"+0987654321",subject:"Support for funeral announcement",message:"I need help creating a funeral announcement for my family. Could you guide me through the process?",status:"read",created_at:new Date(Date.now()-864e5).toISOString()},{id:3,name:"Bob Johnson",email:"bob.johnson@email.com",subject:"Technical issue with login",message:"I am having trouble logging into my account. The login button doesn't seem to work.",status:"responded",created_at:new Date(Date.now()-1728e5).toISOString()}]}viewMessage(t){this.selectedMessage=t}closeModal(){this.selectedMessage=null}updateStatus(t,n){const o=n.target.value;fetch(`https://kilnenterprise.com/Donations/contact.php/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:o})}).then(a=>a.json()).then(a=>{t.status=o}).catch(a=>{t.status=o})}checkAdminPassword(){"lastbutone@12345"===this.adminPassword?(this.isAdmin=!0,this.passwordError="",this.loadMessages()):this.passwordError="Invalid admin password"}togglePasswordVisibility(){this.showPassword=!this.showPassword}clearPassword(){this.adminPassword="",this.showPassword=!1,this.passwordError=""}formatDate(t){const n=new Date(t);return n.toLocaleDateString()+" "+n.toLocaleTimeString()}static{this.\u0275fac=function(n){return new(n||s)(e.rXU(m.G),e.rXU(p.Ix))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-admin"]],standalone:!0,features:[e.aNF],decls:4,vars:2,consts:[[1,"py-20"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8"],["class","max-w-md mx-auto bg-white p-8 rounded-lg shadow-md mb-8",4,"ngIf"],[4,"ngIf"],[1,"max-w-md","mx-auto","bg-white","p-8","rounded-lg","shadow-md","mb-8"],[1,"text-2xl","font-bold","text-gray-900","mb-6"],[1,"text-gray-600","mb-4"],[1,"space-y-4"],["for","adminPassword",1,"block","text-sm","font-medium","text-gray-700"],[1,"relative","mt-1"],["id","adminPassword","placeholder","Enter admin password",1,"block","w-full","px-3","py-2","pr-10","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-blue-500","focus:border-blue-500",3,"ngModelChange","type","ngModel"],["type","button",1,"absolute","inset-y-0","right-0","pr-3","flex","items-center",3,"click","title"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-gray-400","hover:text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4.928 4.928l14.142 14.142","class","text-red-500",4,"ngIf"],["class","text-red-600 text-sm",4,"ngIf"],[1,"w-full","bg-blue-600","text-white","py-2","px-4","rounded-md","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","disabled:bg-gray-400","disabled:cursor-not-allowed",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4.928 4.928l14.142 14.142",1,"text-red-500"],[1,"text-red-600","text-sm"],[1,"mb-8"],[1,"text-3xl","font-bold","text-gray-900"],[1,"mt-2","text-gray-600"],[1,"bg-white","shadow-lg","rounded-lg","overflow-hidden"],[1,"px-6","py-4","bg-gray-50","border-b","border-gray-200"],[1,"text-xl","font-semibold","text-gray-900"],[1,"mt-1","text-sm","text-gray-600"],["class","text-center py-12",4,"ngIf"],["class","p-6 text-center",4,"ngIf"],["class","overflow-x-auto",4,"ngIf"],["class","fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",3,"click",4,"ngIf"],[1,"text-center","py-12"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-12","w-12","text-blue-600","mx-auto"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"mt-4","text-gray-600"],[1,"p-6","text-center"],[1,"bg-red-50","border","border-red-200","rounded-md","p-4"],[1,"text-red-800"],[1,"mt-2","text-red-600","hover:text-red-800","underline",3,"click"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],["class","hover:bg-gray-50",4,"ngFor","ngForOf"],[1,"hover:bg-gray-50"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-medium","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-500"],[1,"px-6","py-4","text-sm","text-gray-900","max-w-xs","truncate"],[1,"px-6","py-4","whitespace-nowrap"],[1,"inline-flex","px-2","py-1","text-xs","font-semibold","rounded-full",3,"ngClass"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-medium"],[1,"text-blue-600","hover:text-blue-900","mr-3",3,"click"],[1,"text-sm","border","border-gray-300","rounded","px-2","py-1",3,"change"],["value","new",3,"selected"],["value","read",3,"selected"],["value","responded",3,"selected"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[1,"fixed","inset-0","bg-gray-600","bg-opacity-50","overflow-y-auto","h-full","w-full","z-50",3,"click"],[1,"relative","top-20","mx-auto","p-5","border","w-11/12","md:w-3/4","lg:w-1/2","shadow-lg","rounded-md","bg-white",3,"click"],[1,"mt-3"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-lg","font-medium","text-gray-900"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"block","text-sm","font-medium","text-gray-700"],[1,"mt-1","text-sm","text-gray-900"],[1,"mt-1","p-3","bg-gray-50","rounded-md"],[1,"text-sm","text-gray-900","whitespace-pre-wrap"]],template:function(n,o){1&n&&(e.j41(0,"div",0)(1,"div",1),e.DNE(2,h,19,9,"div",2)(3,F,16,4,"div",3),e.k0s()()),2&n&&(e.R7$(2),e.Y8G("ngIf",!o.isAdmin),e.R7$(),e.Y8G("ngIf",o.isAdmin))},dependencies:[l.MD,l.YU,l.Sq,l.bT,d.YN,d.xH,d.y7,d.me,d.BC,d.vS],encapsulation:2})}}return s})()}}]);