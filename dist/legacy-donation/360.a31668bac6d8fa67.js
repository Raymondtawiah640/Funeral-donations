"use strict";(self.webpackChunklegacy_donation=self.webpackChunklegacy_donation||[]).push([[360],{5360:(q,g,u)=>{u.r(g),u.d(g,{MyAnnouncementsComponent:()=>z});var _=u(177),f=u(6544),e=u(4438),h=u(3366);const x=(i,o,t)=>({"bg-green-100 text-green-800":i,"bg-yellow-100 text-yellow-800":o,"bg-red-100 text-red-800":t}),v=i=>["/announcements",i];function k(i,o){if(1&i){const t=e.RV6();e.j41(0,"button",20),e.bIt("click",function(){const s=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.setTimeFilter(s.key))}),e.EFF(1),e.k0s()}if(2&i){const t=o.$implicit,n=e.XpG(2);e.AVh("bg-blue-600",n.selectedFilter===t.key)("text-white",n.selectedFilter===t.key)("bg-gray-200",n.selectedFilter!==t.key)("text-gray-700",n.selectedFilter!==t.key),e.R7$(),e.Lme(" ",t.label," (",n.getFilteredCount(t.key),") ")}}function b(i,o){if(1&i&&(e.j41(0,"div",18),e.DNE(1,k,2,10,"button",19),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.timeFilters)}}function F(i,o){1&i&&(e.j41(0,"div",21),e.qSk(),e.j41(1,"svg",22),e.nrm(2,"circle",23)(3,"path",24),e.k0s(),e.joV(),e.j41(4,"p",25),e.EFF(5,"Loading your announcements..."),e.k0s()())}function y(i,o){if(1&i&&(e.j41(0,"div",26)(1,"div",27),e.EFF(2),e.k0s()()),2&i){const t=e.XpG();e.R7$(2),e.JRh(t.error)}}function R(i,o){if(1&i){const t=e.RV6();e.j41(0,"span",51),e.bIt("click",function(){e.eBV(t);const s=e.XpG().$implicit,r=e.XpG(2);return e.Njj(r.markNotificationsAsRead(s.id))}),e.qSk(),e.j41(1,"svg",52),e.nrm(2,"path",53),e.k0s(),e.EFF(3),e.k0s()}if(2&i){const t=e.XpG().$implicit,n=e.XpG(2);e.R7$(3),e.Lme(" ",n.getNewLikesCount(t)," new like",n.getNewLikesCount(t)>1?"s":""," ")}}function w(i,o){if(1&i&&(e.j41(0,"div",60)(1,"span",61),e.EFF(2),e.k0s(),e.j41(3,"span",62),e.EFF(4),e.k0s(),e.j41(5,"span",63),e.EFF(6),e.k0s()()),2&i){const t=o.$implicit,n=e.XpG(4);e.R7$(2),e.JRh("like"===t.reaction_type?"\u{1f44d}":"\u2764\ufe0f"),e.R7$(2),e.JRh(t.name),e.R7$(2),e.JRh(n.getTimeAgo(t.reacted_at))}}function j(i,o){if(1&i&&(e.j41(0,"button",64),e.EFF(1),e.k0s()),2&i){const t=e.XpG(2).$implicit,n=e.XpG(2);e.R7$(),e.SpI(" +",n.getRecentLikers(t).length-3," more ")}}function $(i,o){if(1&i&&(e.j41(0,"div",54)(1,"div",34),e.qSk(),e.j41(2,"svg",55),e.nrm(3,"path",53),e.k0s(),e.joV(),e.j41(4,"span",56),e.EFF(5,"Recent Reactions"),e.k0s()(),e.j41(6,"div",57),e.DNE(7,w,7,3,"div",58),e.k0s(),e.DNE(8,j,2,1,"button",59),e.k0s()),2&i){const t=e.XpG().$implicit,n=e.XpG(2);e.R7$(7),e.Y8G("ngForOf",n.getRecentLikers(t).slice(0,3)),e.R7$(),e.Y8G("ngIf",n.getRecentLikers(t).length>3)}}function M(i,o){if(1&i&&(e.j41(0,"div")(1,"span",65),e.EFF(2,"Passed:"),e.k0s(),e.j41(3,"span",66),e.EFF(4),e.nI1(5,"date"),e.k0s()()),2&i){const t=e.XpG().$implicit;e.R7$(4),e.JRh(e.i5U(5,1,t.deceased_death_date,"longDate"))}}function E(i,o){if(1&i&&(e.j41(0,"div")(1,"span",65),e.EFF(2,"Funeral:"),e.k0s(),e.j41(3,"span",66),e.EFF(4),e.nI1(5,"date"),e.k0s()()),2&i){const t=e.XpG().$implicit;e.R7$(4),e.JRh(e.i5U(5,1,t.funeral_date,"mediumDate"))}}function G(i,o){if(1&i&&(e.j41(0,"div")(1,"span",65),e.EFF(2,"Ends:"),e.k0s(),e.j41(3,"span",66),e.EFF(4),e.nI1(5,"date"),e.k0s()()),2&i){const t=e.XpG().$implicit;e.R7$(4),e.JRh(e.i5U(5,1,t.announcement_end_date,"longDate"))}}function A(i,o){if(1&i&&(e.j41(0,"div")(1,"span",67),e.EFF(2,"Goal:"),e.k0s(),e.j41(3,"span",68),e.EFF(4),e.k0s()()),2&i){const t=e.XpG().$implicit,n=e.XpG(2);e.R7$(4),e.JRh(n.formatCurrency(t.goal_amount))}}function C(i,o){if(1&i){const t=e.RV6();e.j41(0,"button",69),e.bIt("click",function(){e.eBV(t);const s=e.XpG().$implicit,r=e.XpG(2);return e.Njj(r.closeAnnouncement(s.id))}),e.EFF(1," Close "),e.k0s()}if(2&i){const t=e.XpG(3);e.Y8G("disabled",t.isClosing)}}function I(i,o){if(1&i&&(e.j41(0,"div",70),e.nrm(1,"img",71),e.k0s()),2&i){const t=e.XpG().$implicit,n=e.XpG(2);e.R7$(),e.Y8G("src",n.getThumbnailImage(t),e.B4B)("alt",t.deceased_name)}}function T(i,o){if(1&i){const t=e.RV6();e.j41(0,"div",30)(1,"div",31)(2,"div",32)(3,"div",33)(4,"div",34)(5,"h2",35),e.EFF(6),e.k0s(),e.j41(7,"span",36),e.EFF(8),e.nI1(9,"titlecase"),e.k0s(),e.DNE(10,R,4,2,"span",37),e.k0s(),e.j41(11,"p",38),e.EFF(12),e.k0s(),e.j41(13,"div",39)(14,"button",40),e.bIt("click",function(){const s=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.toggleReaction(s,"like"))}),e.j41(15,"span",41),e.EFF(16,"\u{1f44d}"),e.k0s(),e.j41(17,"span"),e.EFF(18),e.k0s()(),e.j41(19,"button",42),e.bIt("click",function(){const s=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.toggleReaction(s,"love"))}),e.j41(20,"span",41),e.EFF(21,"\u2764\ufe0f"),e.k0s(),e.j41(22,"span"),e.EFF(23),e.k0s()()(),e.DNE(24,$,9,2,"div",43),e.j41(25,"div",44),e.DNE(26,M,6,4,"div",45)(27,E,6,4,"div",45)(28,G,6,4,"div",45),e.k0s(),e.j41(29,"div",46)(30,"div",8),e.DNE(31,A,5,1,"div",45),e.k0s(),e.j41(32,"div",47)(33,"a",48),e.EFF(34," View "),e.k0s(),e.DNE(35,C,2,1,"button",49),e.k0s()()(),e.DNE(36,I,2,2,"div",50),e.k0s()()()}if(2&i){const t=o.$implicit,n=e.XpG(2);e.R7$(6),e.JRh(t.deceased_name),e.R7$(),e.Y8G("ngClass",e.sMw(25,x,"active"===t.status,"grace_period"===t.status,"closed"===t.status||"expired"===t.status)),e.R7$(),e.SpI(" ",e.bMT(9,23,t.status)," "),e.R7$(2),e.Y8G("ngIf",n.getNewLikesCount(t)>0),e.R7$(2),e.JRh(n.getMessagePreview(t)),e.R7$(2),e.AVh("text-blue-600","like"===(null==t.reactions?null:t.reactions.user_reaction))("text-gray-400","like"!==(null==t.reactions?null:t.reactions.user_reaction)),e.R7$(4),e.JRh((null==t.reactions?null:t.reactions.likes)||0),e.R7$(),e.AVh("text-red-600","love"===(null==t.reactions?null:t.reactions.user_reaction))("text-gray-400","love"!==(null==t.reactions?null:t.reactions.user_reaction)),e.R7$(4),e.JRh((null==t.reactions?null:t.reactions.loves)||0),e.R7$(),e.Y8G("ngIf",n.getRecentLikers(t).length>0),e.R7$(2),e.Y8G("ngIf",t.deceased_death_date),e.R7$(),e.Y8G("ngIf",t.funeral_date),e.R7$(),e.Y8G("ngIf",t.announcement_end_date),e.R7$(3),e.Y8G("ngIf",t.goal_amount),e.R7$(2),e.Y8G("routerLink",e.eq3(29,v,t.id)),e.R7$(2),e.Y8G("ngIf","active"===t.status&&!t.is_closed),e.R7$(),e.Y8G("ngIf",n.getThumbnailImage(t))}}function D(i,o){if(1&i&&(e.j41(0,"div",28),e.DNE(1,T,37,31,"div",29),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.filteredAnnouncements)}}function Y(i,o){if(1&i){const t=e.RV6();e.j41(0,"span",102),e.bIt("click",function(){e.eBV(t);const s=e.XpG().$implicit,r=e.XpG(3);return e.Njj(r.markNotificationsAsRead(s.id))}),e.qSk(),e.j41(1,"svg",52),e.nrm(2,"path",53),e.k0s(),e.EFF(3),e.k0s()}if(2&i){const t=e.XpG().$implicit,n=e.XpG(3);e.R7$(3),e.SpI(" ",n.getNewLikesCount(t)," ")}}function L(i,o){if(1&i&&(e.j41(0,"div",60)(1,"span",107),e.EFF(2),e.k0s(),e.j41(3,"span",108),e.EFF(4),e.k0s()()),2&i){const t=o.$implicit;e.R7$(2),e.JRh("like"===t.reaction_type?"\u{1f44d}":"\u2764\ufe0f"),e.R7$(2),e.JRh(t.name)}}function X(i,o){if(1&i&&(e.j41(0,"div",103)(1,"div",104),e.qSk(),e.j41(2,"svg",105),e.nrm(3,"path",53),e.k0s(),e.joV(),e.j41(4,"span",106),e.EFF(5,"Recent Reactions"),e.k0s()(),e.j41(6,"div",57),e.DNE(7,L,5,2,"div",58),e.k0s()()),2&i){const t=e.XpG().$implicit,n=e.XpG(3);e.R7$(7),e.Y8G("ngForOf",n.getRecentLikers(t).slice(0,2))}}function N(i,o){if(1&i&&(e.j41(0,"div")(1,"span",65),e.EFF(2,"Passed:"),e.k0s(),e.j41(3,"span",66),e.EFF(4),e.nI1(5,"date"),e.k0s()()),2&i){const t=e.XpG().$implicit;e.R7$(4),e.JRh(e.i5U(5,1,t.deceased_death_date,"longDate"))}}function S(i,o){if(1&i&&(e.j41(0,"div")(1,"span",65),e.EFF(2,"Funeral:"),e.k0s(),e.j41(3,"span",66),e.EFF(4),e.nI1(5,"date"),e.k0s()()),2&i){const t=e.XpG().$implicit;e.R7$(4),e.JRh(e.i5U(5,1,t.funeral_date,"mediumDate"))}}function V(i,o){if(1&i&&(e.j41(0,"div")(1,"span",65),e.EFF(2,"Goal:"),e.k0s(),e.j41(3,"span",66),e.EFF(4),e.k0s()()),2&i){const t=e.XpG().$implicit,n=e.XpG(3);e.R7$(4),e.JRh(n.formatCurrency(t.goal_amount))}}function J(i,o){if(1&i){const t=e.RV6();e.j41(0,"button",109),e.bIt("click",function(){e.eBV(t);const s=e.XpG().$implicit,r=e.XpG(3);return e.Njj(r.closeAnnouncement(s.id))}),e.EFF(1," Close "),e.k0s()}if(2&i){const t=e.XpG(4);e.Y8G("disabled",t.isClosing)}}function O(i,o){if(1&i&&(e.j41(0,"div",110),e.nrm(1,"img",111),e.k0s()),2&i){const t=e.XpG().$implicit,n=e.XpG(3);e.R7$(),e.Y8G("src",n.getThumbnailImage(t),e.B4B)("alt",t.deceased_name)}}function B(i,o){if(1&i){const t=e.RV6();e.j41(0,"div",30)(1,"div",82)(2,"div",83),e.nrm(3,"div",84),e.j41(4,"div",85)(5,"div",86)(6,"div",87)(7,"h4",88),e.EFF(8),e.k0s(),e.j41(9,"span",89),e.EFF(10),e.nI1(11,"titlecase"),e.k0s(),e.DNE(12,Y,4,1,"span",90),e.k0s(),e.j41(13,"span",80),e.EFF(14),e.k0s()(),e.j41(15,"p",91),e.EFF(16),e.k0s(),e.j41(17,"div",92)(18,"button",93),e.bIt("click",function(){const s=e.eBV(t).$implicit,r=e.XpG(3);return e.Njj(r.toggleReaction(s,"like"))}),e.j41(19,"span",94),e.EFF(20,"\u{1f44d}"),e.k0s(),e.j41(21,"span"),e.EFF(22),e.k0s()(),e.j41(23,"button",95),e.bIt("click",function(){const s=e.eBV(t).$implicit,r=e.XpG(3);return e.Njj(r.toggleReaction(s,"love"))}),e.j41(24,"span",94),e.EFF(25,"\u2764\ufe0f"),e.k0s(),e.j41(26,"span"),e.EFF(27),e.k0s()()(),e.DNE(28,X,8,1,"div",96),e.j41(29,"div",97)(30,"div",98),e.DNE(31,N,6,4,"div",45)(32,S,6,4,"div",45)(33,V,5,1,"div",45),e.k0s(),e.j41(34,"div",87)(35,"a",99),e.EFF(36," View Details "),e.k0s(),e.DNE(37,J,2,1,"button",100),e.k0s()()(),e.DNE(38,O,2,2,"div",101),e.k0s()()()}if(2&i){const t=o.$implicit,n=e.XpG(3);e.R7$(8),e.JRh(t.deceased_name),e.R7$(),e.Y8G("ngClass",e.sMw(25,x,"active"===t.status,"grace_period"===t.status,"closed"===t.status||"expired"===t.status)),e.R7$(),e.SpI(" ",e.bMT(11,23,t.status)," "),e.R7$(2),e.Y8G("ngIf",n.getNewLikesCount(t)>0),e.R7$(2),e.JRh(n.getTimeAgo(t.announcement_start_date)),e.R7$(2),e.JRh(n.getMessagePreview(t)),e.R7$(2),e.AVh("text-blue-600","like"===(null==t.reactions?null:t.reactions.user_reaction))("text-gray-400","like"!==(null==t.reactions?null:t.reactions.user_reaction)),e.R7$(4),e.JRh((null==t.reactions?null:t.reactions.likes)||0),e.R7$(),e.AVh("text-red-600","love"===(null==t.reactions?null:t.reactions.user_reaction))("text-gray-400","love"!==(null==t.reactions?null:t.reactions.user_reaction)),e.R7$(4),e.JRh((null==t.reactions?null:t.reactions.loves)||0),e.R7$(),e.Y8G("ngIf",n.getRecentLikers(t).length>0),e.R7$(3),e.Y8G("ngIf",t.deceased_death_date),e.R7$(),e.Y8G("ngIf",t.funeral_date),e.R7$(),e.Y8G("ngIf",t.goal_amount),e.R7$(2),e.Y8G("routerLink",e.eq3(29,v,t.id)),e.R7$(2),e.Y8G("ngIf","active"===t.status&&!t.is_closed),e.R7$(),e.Y8G("ngIf",n.getThumbnailImage(t))}}function P(i,o){if(1&i&&(e.j41(0,"div",72)(1,"div",76)(2,"div",77),e.EFF(3),e.k0s(),e.j41(4,"div",78)(5,"h3",79),e.EFF(6),e.k0s(),e.j41(7,"p",80),e.EFF(8),e.k0s()()(),e.j41(9,"div",81),e.DNE(10,B,39,31,"div",29),e.k0s()()),2&i){const t=o.$implicit,n=e.XpG(2);e.R7$(3),e.SpI(" ",n.getGroupIcon(t.period)," "),e.R7$(3),e.JRh(t.period),e.R7$(2),e.Lme("",t.count," announcement",t.count>1?"s":"",""),e.R7$(2),e.Y8G("ngForOf",t.announcements)}}function U(i,o){if(1&i&&(e.j41(0,"div",72),e.nrm(1,"div",73),e.j41(2,"div",74),e.DNE(3,P,11,5,"div",75),e.k0s()()),2&i){const t=e.XpG();e.R7$(3),e.Y8G("ngForOf",t.groupedAnnouncements)}}function W(i,o){if(1&i&&(e.j41(0,"div",21),e.qSk(),e.j41(1,"svg",112),e.nrm(2,"path",113),e.k0s(),e.joV(),e.j41(3,"h3",114),e.EFF(4),e.k0s(),e.j41(5,"p",115),e.EFF(6),e.k0s(),e.j41(7,"div",116)(8,"a",117),e.EFF(9),e.k0s()()()),2&i){const t=e.XpG();e.R7$(4),e.SpI(" ","timeline"===t.viewMode?"Your announcement timeline is empty":"No announcements yet"," "),e.R7$(2),e.SpI(" ","timeline"===t.viewMode?"Start creating announcements to see your history unfold over time.":"Create your first funeral announcement to get started."," "),e.R7$(3),e.SpI(" ","Create Your First Announcement"," ")}}let z=(()=>{class i{constructor(t){this.apiService=t,this.announcements=[],this.isLoading=!0,this.error="",this.isClosing=!1,this.selectedFilter="all",this.viewMode="timeline",this.timeFilters=[{key:"all",label:"All Time"},{key:"week",label:"This Week"},{key:"month",label:"This Month"},{key:"year",label:"This Year"},{key:"older",label:"Older"}]}toggleReaction(t,n){t.reactions||(t.reactions={likes:0,loves:0,user_reaction:null}),t.reactions.user_reaction===n?this.removeReaction(t):this.addReaction(t,n)}addReaction(t,n){this.apiService.isLoggedIn()?this.apiService.addReaction(t.id,n).subscribe({next:s=>{s.success&&this.updateLocalReaction(t,n)},error:s=>{console.error("Failed to add reaction:",s)}}):(this.updateLocalReaction(t,n),this.saveReactionsToLocalStorage())}removeReaction(t){this.apiService.isLoggedIn()?this.apiService.removeReaction(t.id).subscribe({next:n=>{n.success&&this.updateLocalReaction(t,null)},error:n=>{console.error("Failed to remove reaction:",n)}}):(this.updateLocalReaction(t,null),this.saveReactionsToLocalStorage())}updateLocalReaction(t,n){t.reactions||(t.reactions={likes:0,loves:0,user_reaction:null});const s=t.reactions.user_reaction;"like"===s?t.reactions.likes=Math.max(0,t.reactions.likes-1):"love"===s&&(t.reactions.loves=Math.max(0,t.reactions.loves-1)),"like"===n?t.reactions.likes+=1:"love"===n&&(t.reactions.loves+=1),t.reactions.user_reaction=n}saveReactionsToLocalStorage(){const t={};this.announcements.forEach(n=>{void 0!==n.reactions?.user_reaction&&(t[n.id]=n.reactions.user_reaction)}),localStorage.setItem("announcementReactions",JSON.stringify(t))}loadReactionsFromLocalStorage(){const t=localStorage.getItem("announcementReactions");if(t)try{const n=JSON.parse(t);this.announcements.forEach(s=>{void 0!==n[s.id]&&(s.reactions||(s.reactions={likes:0,loves:0,user_reaction:null}),s.reactions.user_reaction=n[s.id])})}catch(n){console.error("Failed to load reactions from localStorage:",n)}}ngOnInit(){this.loadAnnouncements()}loadAnnouncements(){this.isLoading=!0,this.error="",this.apiService.getUserAnnouncements().subscribe({next:t=>{this.isLoading=!1,t.success?(this.announcements=t.data,this.apiService.isLoggedIn()||this.loadReactionsFromLocalStorage(),this.apiService.isLoggedIn()&&this.loadNotifications()):this.error=t.error||"Failed to load your announcements"},error:t=>{this.isLoading=!1,this.error=this.apiService.getErrorMessage(t)}})}loadNotifications(){this.apiService.getReactionNotifications().subscribe({next:t=>{t.success&&t.data&&this.announcements.forEach(n=>{t.data[n.id]&&(n.notifications=t.data[n.id])})},error:t=>{console.error("Failed to load notifications:",t)}})}markNotificationsAsRead(t){const n=this.announcements.find(s=>s.id===t);n?.notifications&&this.apiService.markNotificationsRead(t).subscribe({next:s=>{s.success&&(n.notifications={new_likes:0,recent_likers:[]})},error:s=>{console.error("Failed to mark notifications as read:",s)}})}closeAnnouncement(t){confirm("Are you sure you want to close this announcement? This action cannot be undone.")&&(this.isClosing=!0,this.apiService.closeAnnouncement(t).subscribe({next:n=>{if(this.isClosing=!1,n.success){const s=this.announcements.find(r=>r.id===t);s&&(s.status="closed",s.is_closed=!0)}else this.error=n.error||"Failed to close announcement"},error:n=>{this.isClosing=!1,this.error=this.apiService.getErrorMessage(n)}}))}getThumbnailImage(t){const n=t.files?.find(s=>"deceased_photo"===s.upload_purpose);return n&&"image"===n.file_type?`https://kilnenterprise.com/Donations/${n.file_path}`:null}formatCurrency(t){return`GH\u20b5${("string"==typeof t?parseFloat(t):t||0).toFixed(2)}`}getMessagePreview(t){const n=t.family_message||"";return n.length>150?n.substring(0,150)+"...":n}setTimeFilter(t){this.selectedFilter=t}get filteredAnnouncements(){if("all"===this.selectedFilter)return this.announcements;const t=new Date;return this.announcements.filter(n=>{const s=new Date(n.announcement_start_date);switch(this.selectedFilter){case"week":return s>=new Date(t.getTime()-6048e5);case"month":return s>=new Date(t.getFullYear(),t.getMonth()-1,t.getDate());case"year":return s>=new Date(t.getFullYear()-1,t.getMonth(),t.getDate());case"older":return s<new Date(t.getFullYear()-1,t.getMonth(),t.getDate());default:return!0}})}getFilteredCount(t){if("all"===t)return this.announcements.length;const n=new Date;return this.announcements.filter(s=>{const r=new Date(s.announcement_start_date);switch(t){case"week":return r>=new Date(n.getTime()-6048e5);case"month":return r>=new Date(n.getFullYear(),n.getMonth()-1,n.getDate());case"year":return r>=new Date(n.getFullYear()-1,n.getMonth(),n.getDate());case"older":return r<new Date(n.getFullYear()-1,n.getMonth(),n.getDate());default:return!0}}).length}get groupedAnnouncements(){const t=new Date,n={};this.announcements.forEach(a=>{const c=new Date(a.announcement_start_date),d=t.getTime()-c.getTime(),l=Math.floor(d/864e5);let m="";if(0===l)m="Today";else if(1===l)m="Yesterday";else if(l<=7)m="This Week";else if(l<=30)m="This Month";else if(l<=365)m="This Year";else{const p=Math.floor(l/365);m=`${p} Year${p>1?"s":""} Ago`}n[m]||(n[m]=[]),n[m].push(a)});const s=["Today","Yesterday","This Week","This Month","This Year"];return Object.keys(n).sort((a,c)=>{const d=s.indexOf(a),l=s.indexOf(c);return-1!==d&&-1!==l?d-l:-1!==d?-1:-1!==l?1:parseInt(a.split(" ")[0])-parseInt(c.split(" ")[0])}).map(a=>({period:a,announcements:n[a].sort((c,d)=>new Date(d.announcement_start_date).getTime()-new Date(c.announcement_start_date).getTime()),count:n[a].length}))}getGroupIcon(t){switch(t){case"Today":return"\u{1f4c5}";case"Yesterday":return"\u{1f4c6}";case"This Week":return"\u{1f4ca}";case"This Month":return"\u{1f4c8}";case"This Year":return"\u{1f3af}";default:return"\u{1f4da}"}}getTimeAgo(t){const n=new Date,s=new Date(t),r=n.getTime()-s.getTime(),a=Math.floor(r/864e5);if(0===a)return"Today";if(1===a)return"Yesterday";if(a<7)return`${a} days ago`;if(a<30){const c=Math.floor(a/7);return`${c} week${c>1?"s":""} ago`}if(a<365){const c=Math.floor(a/30);return`${c} month${c>1?"s":""} ago`}{const c=Math.floor(a/365);return`${c} year${c>1?"s":""} ago`}}getNewLikesCount(t){return t.notifications?.new_likes||0}getRecentLikers(t){return t.notifications?.recent_likers||[]}static{this.\u0275fac=function(n){return new(n||i)(e.rXU(h.G))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-my-announcements"]],standalone:!0,features:[e.aNF],decls:26,vars:22,consts:[[1,"min-h-screen","bg-gray-50","py-12"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"mb-8"],[1,"flex","flex-col","sm:flex-row","sm:justify-between","sm:items-center","gap-4"],[1,"text-2xl","sm:text-3xl","font-bold","text-gray-900"],[1,"mt-2","text-gray-600"],["routerLink","/create-announcement",1,"inline-flex","items-center","px-4","sm:px-6","py-3","border","border-transparent","text-sm","sm:text-base","font-medium","rounded-md","text-white","bg-blue-600","hover:bg-blue-700","self-start","sm:self-auto"],[1,"mt-6","flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between","gap-4"],[1,"flex","items-center","space-x-4"],[1,"text-sm","font-medium","text-gray-700"],[1,"flex","rounded-md","shadow-sm"],[1,"px-3","sm:px-4","py-2","text-sm","font-medium","rounded-l-md","border","border-gray-300","hover:bg-blue-700","hover:text-white","transition-colors",3,"click"],[1,"px-3","sm:px-4","py-2","text-sm","font-medium","rounded-r-md","border-t","border-r","border-b","border-gray-300","hover:bg-blue-700","hover:text-white","transition-colors",3,"click"],["class","flex flex-wrap gap-2",4,"ngIf"],["class","text-center py-12",4,"ngIf"],["class","bg-red-50 border border-red-200 rounded-md p-4 mb-8",4,"ngIf"],["class","space-y-6",4,"ngIf"],["class","relative",4,"ngIf"],[1,"flex","flex-wrap","gap-2"],["class","px-3 sm:px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-700 hover:text-white transition-colors",3,"bg-blue-600","text-white","bg-gray-200","text-gray-700","click",4,"ngFor","ngForOf"],[1,"px-3","sm:px-4","py-2","rounded-md","text-sm","font-medium","hover:bg-blue-700","hover:text-white","transition-colors",3,"click"],[1,"text-center","py-12"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-12","w-12","text-blue-600","mx-auto"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"mt-4","text-gray-600"],[1,"bg-red-50","border","border-red-200","rounded-md","p-4","mb-8"],[1,"text-red-600","text-sm"],[1,"space-y-6"],["class","bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow",4,"ngFor","ngForOf"],[1,"bg-white","rounded-lg","shadow-md","overflow-hidden","hover:shadow-lg","transition-shadow"],[1,"p-6"],[1,"flex","flex-col","lg:flex-row","lg:items-start"],[1,"flex-1","lg:mr-6"],[1,"flex","items-center","mb-2"],[1,"text-xl","font-semibold","text-gray-900"],[1,"ml-3","inline-flex","items-center","px-3","py-1","rounded-full","text-sm","font-medium",3,"ngClass"],["class","ml-3 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800 animate-pulse cursor-pointer",3,"click",4,"ngIf"],[1,"text-gray-600","mb-4"],[1,"flex","items-center","space-x-4","mb-4"],[1,"flex","items-center","space-x-1","hover:text-blue-600","transition-colors","text-sm",3,"click"],[1,"text-lg"],[1,"flex","items-center","space-x-1","hover:text-red-600","transition-colors","text-sm",3,"click"],["class","mb-4 p-3 bg-blue-50 rounded-lg border border-blue-200",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4","text-sm"],[4,"ngIf"],[1,"mt-4","flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between","gap-2"],[1,"flex","items-center","space-x-3"],[1,"text-blue-600","hover:text-blue-800","font-medium","text-sm",3,"routerLink"],["class","text-red-600 hover:text-red-800 font-medium text-sm",3,"disabled","click",4,"ngIf"],["class","mt-4 lg:mt-0 lg:ml-6 flex-shrink-0 mx-auto lg:mx-0",4,"ngIf"],[1,"ml-3","inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-red-100","text-red-800","animate-pulse","cursor-pointer",3,"click"],["fill","currentColor","viewBox","0 0 20 20",1,"w-3","h-3","mr-1"],["d","M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"],[1,"mb-4","p-3","bg-blue-50","rounded-lg","border","border-blue-200"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-blue-600","mr-2"],[1,"text-sm","font-medium","text-blue-800"],[1,"space-y-1"],["class","flex items-center text-xs text-blue-700",4,"ngFor","ngForOf"],["class","mt-2 text-xs text-blue-600 hover:text-blue-800",4,"ngIf"],[1,"flex","items-center","text-xs","text-blue-700"],[1,"mr-2"],[1,"font-medium"],[1,"ml-auto","text-blue-500"],[1,"mt-2","text-xs","text-blue-600","hover:text-blue-800"],[1,"font-medium","text-gray-500"],[1,"ml-1","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"ml-1","font-medium","text-gray-900"],[1,"text-red-600","hover:text-red-800","font-medium","text-sm",3,"click","disabled"],[1,"mt-4","lg:mt-0","lg:ml-6","flex-shrink-0","mx-auto","lg:mx-0"],[1,"h-24","w-24","lg:h-32","lg:w-32","object-contain","rounded-lg","shadow-md",3,"src","alt"],[1,"relative"],[1,"absolute","left-4","sm:left-6","lg:left-8","top-0","bottom-0","w-0.5","bg-gray-300"],[1,"space-y-6","sm:space-y-8"],["class","relative",4,"ngFor","ngForOf"],[1,"flex","items-center","mb-4"],[1,"flex-shrink-0","w-12","h-12","sm:w-14","sm:h-14","lg:w-16","lg:h-16","bg-blue-600","rounded-full","flex","items-center","justify-center","text-white","font-bold","text-xs","sm:text-sm","z-10"],[1,"ml-2","sm:ml-3","lg:ml-4"],[1,"text-base","sm:text-lg","font-semibold","text-gray-900"],[1,"text-xs","sm:text-sm","text-gray-500"],[1,"ml-8","sm:ml-12","lg:ml-20","space-y-4"],[1,"p-4"],[1,"flex","items-start","space-x-2","sm:space-x-3","lg:space-x-4"],[1,"flex-shrink-0","w-3","h-3","sm:w-4","sm:h-4","bg-blue-600","rounded-full","mt-2"],[1,"flex-1","min-w-0"],[1,"flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between","mb-2","gap-2"],[1,"flex","items-center","space-x-2","sm:space-x-3"],[1,"text-base","sm:text-lg","font-semibold","text-gray-900","truncate"],[1,"inline-flex","items-center","px-2","py-0.5","sm:px-2.5","sm:py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],["class","inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800 animate-pulse cursor-pointer",3,"click",4,"ngIf"],[1,"text-gray-600","mb-3","text-sm","sm:text-base"],[1,"flex","items-center","space-x-4","mb-3"],[1,"flex","items-center","space-x-1","hover:text-blue-600","transition-colors","text-xs","sm:text-sm",3,"click"],[1,"text-base","sm:text-lg"],[1,"flex","items-center","space-x-1","hover:text-red-600","transition-colors","text-xs","sm:text-sm",3,"click"],["class","mb-3 p-2 bg-blue-50 rounded border border-blue-200",4,"ngIf"],[1,"flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between","gap-2"],[1,"flex","flex-wrap","items-center","gap-x-4","gap-y-1","text-xs","sm:text-sm"],[1,"text-blue-600","hover:text-blue-800","font-medium","text-xs","sm:text-sm",3,"routerLink"],["class","text-red-600 hover:text-red-800 font-medium text-xs sm:text-sm",3,"disabled","click",4,"ngIf"],["class","flex-shrink-0",4,"ngIf"],[1,"inline-flex","items-center","px-2","py-0.5","rounded-full","text-xs","font-medium","bg-red-100","text-red-800","animate-pulse","cursor-pointer",3,"click"],[1,"mb-3","p-2","bg-blue-50","rounded","border","border-blue-200"],[1,"flex","items-center","mb-1"],["fill","currentColor","viewBox","0 0 20 20",1,"w-3","h-3","text-blue-600","mr-1"],[1,"text-xs","font-medium","text-blue-800"],[1,"mr-1"],[1,"font-medium","truncate"],[1,"text-red-600","hover:text-red-800","font-medium","text-xs","sm:text-sm",3,"click","disabled"],[1,"flex-shrink-0"],[1,"h-12","w-12","sm:h-14","sm:w-14","lg:h-16","lg:w-16","object-contain","rounded-lg","shadow-sm",3,"src","alt"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-16","w-16","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2M4 13h2m10-4h.01M16 5h.01"],[1,"mt-4","text-lg","font-medium","text-gray-900"],[1,"mt-2","text-gray-500"],[1,"mt-6"],["routerLink","/create-announcement",1,"inline-flex","items-center","px-6","py-3","border","border-transparent","text-base","font-medium","rounded-md","text-white","bg-blue-600","hover:bg-blue-700"]],template:function(n,s){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"h1",4),e.EFF(6,"My Announcements"),e.k0s(),e.j41(7,"p",5),e.EFF(8,"Manage your funeral announcements"),e.k0s()(),e.j41(9,"a",6),e.EFF(10," Create New Announcement "),e.k0s()(),e.j41(11,"div",7)(12,"div",8)(13,"span",9),e.EFF(14,"View:"),e.k0s(),e.j41(15,"div",10)(16,"button",11),e.bIt("click",function(){return s.viewMode="list"}),e.EFF(17," List View "),e.k0s(),e.j41(18,"button",12),e.bIt("click",function(){return s.viewMode="timeline"}),e.EFF(19," Timeline View "),e.k0s()()(),e.DNE(20,b,2,1,"div",13),e.k0s()(),e.DNE(21,F,6,0,"div",14)(22,y,3,1,"div",15)(23,D,2,1,"div",16)(24,U,4,1,"div",17)(25,W,10,3,"div",14),e.k0s()()),2&n&&(e.R7$(16),e.AVh("bg-blue-600","list"===s.viewMode)("text-white","list"===s.viewMode)("bg-gray-200","list"!==s.viewMode)("text-gray-700","list"!==s.viewMode),e.R7$(2),e.AVh("bg-blue-600","timeline"===s.viewMode)("text-white","timeline"===s.viewMode)("bg-gray-200","timeline"!==s.viewMode)("text-gray-700","timeline"!==s.viewMode),e.R7$(2),e.Y8G("ngIf","list"===s.viewMode),e.R7$(),e.Y8G("ngIf",s.isLoading),e.R7$(),e.Y8G("ngIf",s.error&&!s.isLoading),e.R7$(),e.Y8G("ngIf","list"===s.viewMode&&!s.isLoading&&s.filteredAnnouncements.length>0),e.R7$(),e.Y8G("ngIf","timeline"===s.viewMode&&!s.isLoading&&s.announcements.length>0),e.R7$(),e.Y8G("ngIf",!s.isLoading&&0===s.announcements.length))},dependencies:[_.MD,_.YU,_.Sq,_.bT,_.PV,_.vh,f.iI,f.Wk],encapsulation:2})}}return i})()}}]);