"use strict";(self.webpackChunklegacy_donation=self.webpackChunklegacy_donation||[]).push([[360],{5360:(M,d,r)=>{r.r(d),r.d(d,{MyAnnouncementsComponent:()=>C});var a=r(177),m=r(6544),e=r(4438),l=r(3366);const u=(t,o,n)=>({"bg-green-100 text-green-800":t,"bg-yellow-100 text-yellow-800":o,"bg-red-100 text-red-800":n}),_=t=>["/announcements",t];function g(t,o){1&t&&(e.j41(0,"div",10),e.qSk(),e.j41(1,"svg",11),e.nrm(2,"circle",12)(3,"path",13),e.k0s(),e.joV(),e.j41(4,"p",14),e.EFF(5,"Loading your announcements..."),e.k0s()())}function p(t,o){if(1&t&&(e.j41(0,"div",15)(1,"div",16),e.EFF(2),e.k0s()()),2&t){const n=e.XpG();e.R7$(2),e.JRh(n.error)}}function f(t,o){if(1&t&&(e.j41(0,"div")(1,"span",29),e.EFF(2,"Passed:"),e.k0s(),e.j41(3,"span",30),e.EFF(4),e.nI1(5,"date"),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(4),e.JRh(e.i5U(5,1,n.deceased_death_date,"longDate"))}}function v(t,o){if(1&t&&(e.j41(0,"div")(1,"span",29),e.EFF(2,"Funeral:"),e.k0s(),e.j41(3,"span",30),e.EFF(4),e.nI1(5,"date"),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(4),e.JRh(e.i5U(5,1,n.funeral_date,"mediumDate"))}}function h(t,o){if(1&t&&(e.j41(0,"div")(1,"span",29),e.EFF(2,"Ends:"),e.k0s(),e.j41(3,"span",30),e.EFF(4),e.nI1(5,"date"),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(4),e.JRh(e.i5U(5,1,n.announcement_end_date,"longDate"))}}function x(t,o){if(1&t&&(e.j41(0,"div")(1,"span",37),e.EFF(2,"Goal:"),e.k0s(),e.j41(3,"span",38),e.EFF(4),e.k0s()()),2&t){const n=e.XpG().$implicit,s=e.XpG(2);e.R7$(4),e.JRh(s.formatCurrency(n.goal_amount))}}function y(t,o){if(1&t&&(e.j41(0,"div")(1,"span",37),e.EFF(2,"Progress:"),e.k0s(),e.j41(3,"span",38),e.EFF(4),e.nI1(5,"number"),e.k0s()()),2&t){const n=e.XpG().$implicit,s=e.XpG(2);e.R7$(4),e.SpI("",e.i5U(5,1,s.getProgressPercentage(n),"1.0-0"),"%")}}function F(t,o){if(1&t){const n=e.RV6();e.j41(0,"button",39),e.bIt("click",function(){e.eBV(n);const i=e.XpG().$implicit,c=e.XpG(2);return e.Njj(c.closeAnnouncement(i.id))}),e.EFF(1," Close "),e.k0s()}if(2&t){const n=e.XpG(3);e.Y8G("disabled",n.isClosing)}}function b(t,o){if(1&t&&(e.j41(0,"div",40),e.nrm(1,"img",41),e.k0s()),2&t){const n=e.XpG().$implicit,s=e.XpG(2);e.R7$(),e.Y8G("src",s.getThumbnailImage(n),e.B4B)("alt",n.deceased_name)}}function k(t,o){if(1&t&&(e.j41(0,"div",19)(1,"div",20)(2,"div",21)(3,"div",22)(4,"div",23)(5,"h2",24),e.EFF(6),e.k0s(),e.j41(7,"span",25),e.EFF(8),e.nI1(9,"titlecase"),e.k0s()(),e.j41(10,"p",26),e.EFF(11),e.k0s(),e.j41(12,"div",27),e.DNE(13,f,6,4,"div",28)(14,v,6,4,"div",28)(15,h,6,4,"div",28),e.j41(16,"div")(17,"span",29),e.EFF(18,"Donations:"),e.k0s(),e.j41(19,"span",30),e.EFF(20),e.k0s()()(),e.j41(21,"div",31)(22,"div",32),e.DNE(23,x,5,1,"div",28)(24,y,6,4,"div",28),e.k0s(),e.j41(25,"div",33)(26,"a",34),e.EFF(27," View "),e.k0s(),e.DNE(28,F,2,1,"button",35),e.k0s()()(),e.DNE(29,b,2,2,"div",36),e.k0s()()()),2&t){const n=o.$implicit,s=e.XpG(2);e.R7$(6),e.JRh(n.deceased_name),e.R7$(),e.Y8G("ngClass",e.sMw(15,u,"active"===n.status,"grace_period"===n.status,"closed"===n.status||"expired"===n.status)),e.R7$(),e.SpI(" ",e.bMT(9,13,n.status)," "),e.R7$(3),e.JRh(s.getMessagePreview(n)),e.R7$(2),e.Y8G("ngIf",n.deceased_death_date),e.R7$(),e.Y8G("ngIf",n.funeral_date),e.R7$(),e.Y8G("ngIf",n.announcement_end_date),e.R7$(5),e.JRh(s.formatCurrency(n.total_raised||0)),e.R7$(3),e.Y8G("ngIf",n.goal_amount),e.R7$(),e.Y8G("ngIf",n.goal_amount&&n.goal_amount>0),e.R7$(2),e.Y8G("routerLink",e.eq3(19,_,n.id)),e.R7$(2),e.Y8G("ngIf","active"===n.status&&!n.is_closed),e.R7$(),e.Y8G("ngIf",s.getThumbnailImage(n))}}function E(t,o){if(1&t&&(e.j41(0,"div",17),e.DNE(1,k,30,21,"div",18),e.k0s()),2&t){const n=e.XpG();e.R7$(),e.Y8G("ngForOf",n.announcements)}}function j(t,o){1&t&&(e.j41(0,"div",10),e.qSk(),e.j41(1,"svg",42),e.nrm(2,"path",43),e.k0s(),e.joV(),e.j41(3,"h3",44),e.EFF(4,"No announcements yet"),e.k0s(),e.j41(5,"p",45),e.EFF(6,"Create your first funeral announcement to get started."),e.k0s(),e.j41(7,"div",46)(8,"a",6),e.EFF(9," Create Your First Announcement "),e.k0s()()())}let C=(()=>{class t{constructor(n){this.apiService=n,this.announcements=[],this.isLoading=!0,this.error="",this.isClosing=!1}ngOnInit(){this.loadAnnouncements()}loadAnnouncements(){this.isLoading=!0,this.error="",this.apiService.getUserAnnouncements().subscribe({next:n=>{this.isLoading=!1,n.success?this.announcements=n.data:this.error=n.error||"Failed to load your announcements"},error:n=>{this.isLoading=!1,this.error=this.apiService.getErrorMessage(n)}})}closeAnnouncement(n){confirm("Are you sure you want to close this announcement? This action cannot be undone.")&&(this.isClosing=!0,this.apiService.closeAnnouncement(n).subscribe({next:s=>{if(this.isClosing=!1,s.success){const i=this.announcements.find(c=>c.id===n);i&&(i.status="closed",i.is_closed=!0)}else this.error=s.error||"Failed to close announcement"},error:s=>{this.isClosing=!1,this.error=this.apiService.getErrorMessage(s)}}))}getProgressPercentage(n){return n.goal_amount&&0!==n.goal_amount?Math.min((n.total_raised||0)/n.goal_amount*100,100):0}getThumbnailImage(n){const s=n.files?.find(i=>"deceased_photo"===i.upload_purpose);return s&&"image"===s.file_type?`https://kilnenterprise.com/Donations/api/${s.file_path}`:null}formatCurrency(n){return`GH\u20b5${("string"==typeof n?parseFloat(n):n||0).toFixed(2)}`}getMessagePreview(n){const s=n.family_message||"";return s.length>150?s.substring(0,150)+"...":s}static{this.\u0275fac=function(s){return new(s||t)(e.rXU(l.G))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-my-announcements"]],standalone:!0,features:[e.aNF],decls:15,vars:4,consts:[[1,"min-h-screen","bg-gray-50","py-12"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"mb-8"],[1,"flex","justify-between","items-center"],[1,"text-3xl","font-bold","text-gray-900"],[1,"mt-2","text-gray-600"],["routerLink","/create-announcement",1,"inline-flex","items-center","px-6","py-3","border","border-transparent","text-base","font-medium","rounded-md","text-white","bg-blue-600","hover:bg-blue-700"],["class","text-center py-12",4,"ngIf"],["class","bg-red-50 border border-red-200 rounded-md p-4 mb-8",4,"ngIf"],["class","space-y-6",4,"ngIf"],[1,"text-center","py-12"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-12","w-12","text-blue-600","mx-auto"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"mt-4","text-gray-600"],[1,"bg-red-50","border","border-red-200","rounded-md","p-4","mb-8"],[1,"text-red-600","text-sm"],[1,"space-y-6"],["class","bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow",4,"ngFor","ngForOf"],[1,"bg-white","rounded-lg","shadow-md","overflow-hidden","hover:shadow-lg","transition-shadow"],[1,"p-6"],[1,"flex","items-start","justify-between"],[1,"flex-1"],[1,"flex","items-center","mb-2"],[1,"text-xl","font-semibold","text-gray-900"],[1,"ml-3","inline-flex","items-center","px-3","py-1","rounded-full","text-sm","font-medium",3,"ngClass"],[1,"text-gray-600","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4","text-sm"],[4,"ngIf"],[1,"font-medium","text-gray-500"],[1,"ml-1","text-gray-900"],[1,"mt-4","flex","items-center","justify-between"],[1,"flex","items-center","space-x-4"],[1,"flex","items-center","space-x-3"],[1,"text-blue-600","hover:text-blue-800","font-medium",3,"routerLink"],["class","text-red-600 hover:text-red-800 font-medium",3,"disabled","click",4,"ngIf"],["class","ml-6 flex-shrink-0",4,"ngIf"],[1,"text-sm","text-gray-500"],[1,"ml-1","font-medium","text-gray-900"],[1,"text-red-600","hover:text-red-800","font-medium",3,"click","disabled"],[1,"ml-6","flex-shrink-0"],[1,"h-20","w-20","object-cover","rounded-lg","shadow-md",3,"src","alt"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-16","w-16","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2M4 13h2m10-4h.01M16 5h.01"],[1,"mt-4","text-lg","font-medium","text-gray-900"],[1,"mt-2","text-gray-500"],[1,"mt-6"]],template:function(s,i){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"h1",4),e.EFF(6,"My Announcements"),e.k0s(),e.j41(7,"p",5),e.EFF(8,"Manage your funeral announcements"),e.k0s()(),e.j41(9,"a",6),e.EFF(10," Create New Announcement "),e.k0s()()(),e.DNE(11,g,6,0,"div",7)(12,p,3,1,"div",8)(13,E,2,1,"div",9)(14,j,10,0,"div",7),e.k0s()()),2&s&&(e.R7$(11),e.Y8G("ngIf",i.isLoading),e.R7$(),e.Y8G("ngIf",i.error&&!i.isLoading),e.R7$(),e.Y8G("ngIf",!i.isLoading&&i.announcements.length>0),e.R7$(),e.Y8G("ngIf",!i.isLoading&&0===i.announcements.length))},dependencies:[a.MD,a.YU,a.Sq,a.bT,a.QX,a.PV,a.vh,m.iI,m.Wk],encapsulation:2})}}return t})()}}]);