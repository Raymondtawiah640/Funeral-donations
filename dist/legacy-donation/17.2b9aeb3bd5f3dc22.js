"use strict";(self.webpackChunklegacy_donation=self.webpackChunklegacy_donation||[]).push([[17],{3017:(I,_,d)=>{d.r(_),d.d(_,{CreateAnnouncementComponent:()=>M});var f=d(177),a=d(4341),e=d(4438),p=d(3366),h=d(6544);function k(o,i){1&o&&(e.j41(0,"div",49),e.EFF(1," Name is required "),e.k0s())}function F(o,i){1&o&&(e.j41(0,"div",49),e.EFF(1," Family message is required "),e.k0s())}function v(o,i){1&o&&(e.j41(0,"div",49),e.EFF(1," Beneficiary name is required "),e.k0s())}function E(o,i){1&o&&(e.j41(0,"div")(1,"label",50),e.EFF(2," Bank Account Number * "),e.k0s(),e.nrm(3,"input",51),e.k0s())}function C(o,i){1&o&&(e.j41(0,"div")(1,"label",52),e.EFF(2," Mobile Money Number * "),e.k0s(),e.nrm(3,"input",53),e.k0s())}function x(o,i){1&o&&(e.j41(0,"div",49),e.EFF(1," Start date is required "),e.k0s())}function w(o,i){1&o&&(e.j41(0,"div",49),e.EFF(1," End date is required and must be after start date "),e.k0s())}function j(o,i){if(1&o&&(e.j41(0,"div",54)(1,"div",55),e.EFF(2),e.k0s()()),2&o){const t=e.XpG();e.R7$(2),e.JRh(t.errorMessage)}}function D(o,i){if(1&o&&(e.j41(0,"div",56)(1,"div",57),e.EFF(2),e.k0s()()),2&o){const t=e.XpG();e.R7$(2),e.JRh(t.successMessage)}}function A(o,i){1&o&&(e.j41(0,"span"),e.EFF(1,"Create Announcement"),e.k0s())}function T(o,i){1&o&&(e.j41(0,"span",58),e.qSk(),e.j41(1,"svg",59),e.nrm(2,"circle",60)(3,"path",61),e.k0s(),e.EFF(4," Creating... "),e.k0s())}let M=(()=>{class o{constructor(t,r,n){this.fb=t,this.apiService=r,this.router=n,this.isLoading=!1,this.errorMessage="",this.successMessage="",this.today=(new Date).toISOString().split("T")[0],this.announcementForm=this.fb.group({deceased_name:["",a.k0.required],deceased_birth_date:[""],deceased_death_date:[""],funeral_date:[""],funeral_location:[""],ceremony_type:["burial"],family_message:["",a.k0.required],goal_amount:[""],beneficiary_name:["",a.k0.required],beneficiary_bank_account:[""],beneficiary_mobile_money:[""],beneficiary_account_type:["bank",a.k0.required],announcement_start_date:[this.today,a.k0.required],announcement_end_date:["",a.k0.required]})}ngOnInit(){this.announcementForm.get("announcement_start_date")?.valueChanges.subscribe(t=>{if(t){const r=new Date(t);r.setDate(r.getDate()+1),this.announcementForm.get("announcement_end_date")?.setValidators([a.k0.required,n=>new Date(n.value)>r?null:{minEndDate:!0}])}})}onAccountTypeChange(){"bank"===this.announcementForm.get("beneficiary_account_type")?.value?(this.announcementForm.get("beneficiary_bank_account")?.setValidators([a.k0.required]),this.announcementForm.get("beneficiary_mobile_money")?.clearValidators()):(this.announcementForm.get("beneficiary_mobile_money")?.setValidators([a.k0.required]),this.announcementForm.get("beneficiary_bank_account")?.clearValidators()),this.announcementForm.get("beneficiary_bank_account")?.updateValueAndValidity(),this.announcementForm.get("beneficiary_mobile_money")?.updateValueAndValidity()}onSubmit(){if(this.announcementForm.invalid)return void this.markFormGroupTouched(this.announcementForm);this.errorMessage="",this.successMessage="",this.isLoading=!0;const t=this.announcementForm.value,r={deceased_name:t.deceased_name,deceased_birth_date:t.deceased_birth_date||void 0,deceased_death_date:t.deceased_death_date||void 0,funeral_date:t.funeral_date||void 0,funeral_location:t.funeral_location||void 0,ceremony_type:t.ceremony_type||"burial",family_message:t.family_message,goal_amount:t.goal_amount?parseFloat(t.goal_amount):void 0,beneficiary_name:t.beneficiary_name,beneficiary_bank_account:"bank"===t.beneficiary_account_type?t.beneficiary_bank_account:void 0,beneficiary_mobile_money:"mobile_money"===t.beneficiary_account_type?t.beneficiary_mobile_money:void 0,beneficiary_account_type:t.beneficiary_account_type,announcement_start_date:t.announcement_start_date,announcement_end_date:t.announcement_end_date};this.apiService.createAnnouncement(r).subscribe({next:n=>{this.isLoading=!1,n.success?(this.successMessage="Announcement created successfully!",setTimeout(()=>{this.router.navigate(["/my-announcements"])},1500)):this.errorMessage=n.error||"Failed to create announcement"},error:n=>{this.isLoading=!1,this.errorMessage=this.apiService.getErrorMessage(n)}})}cancel(){this.router.navigate(["/my-announcements"])}markFormGroupTouched(t){Object.keys(t.controls).forEach(r=>{t.get(r)?.markAsTouched()})}static{this.\u0275fac=function(r){return new(r||o)(e.rXU(a.ok),e.rXU(p.G),e.rXU(h.Ix))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-create-announcement"]],standalone:!0,features:[e.aNF],decls:98,vars:15,consts:[[1,"min-h-screen","bg-gray-50","py-12"],[1,"max-w-3xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"bg-white","shadow","rounded-lg"],[1,"px-4","py-5","sm:p-6"],[1,"text-2xl","font-bold","text-gray-900","mb-6"],[1,"space-y-6",3,"ngSubmit","formGroup"],[1,"bg-gray-50","p-4","rounded-lg"],[1,"text-lg","font-medium","text-gray-900","mb-4"],[1,"grid","grid-cols-1","gap-4","sm:grid-cols-2"],[1,"sm:col-span-2"],["for","deceased_name",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","deceased_name","formControlName","deceased_name","placeholder","Enter full name",1,"mt-1","block","w-full","border-gray-300","rounded-md","shadow-sm","focus:ring-blue-500","focus:border-blue-500"],["class","text-red-500 text-sm mt-1",4,"ngIf"],["for","deceased_birth_date",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","deceased_birth_date","formControlName","deceased_birth_date",1,"mt-1","block","w-full","border-gray-300","rounded-md","shadow-sm","focus:ring-blue-500","focus:border-blue-500"],["for","deceased_death_date",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","deceased_death_date","formControlName","deceased_death_date",1,"mt-1","block","w-full","border-gray-300","rounded-md","shadow-sm","focus:ring-blue-500","focus:border-blue-500"],["for","funeral_date",1,"block","text-sm","font-medium","text-gray-700"],["type","datetime-local","id","funeral_date","formControlName","funeral_date",1,"mt-1","block","w-full","border-gray-300","rounded-md","shadow-sm","focus:ring-blue-500","focus:border-blue-500"],["for","ceremony_type",1,"block","text-sm","font-medium","text-gray-700"],["id","ceremony_type","formControlName","ceremony_type",1,"mt-1","block","w-full","border-gray-300","rounded-md","shadow-sm","focus:ring-blue-500","focus:border-blue-500"],["value","burial"],["value","cremation"],["value","memorial"],["value","other"],["for","funeral_location",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","funeral_location","formControlName","funeral_location","placeholder","Enter venue name and address",1,"mt-1","block","w-full","border-gray-300","rounded-md","shadow-sm","focus:ring-blue-500","focus:border-blue-500"],["for","family_message",1,"block","text-sm","font-medium","text-gray-700"],["id","family_message","formControlName","family_message","rows","4","placeholder","Share a message about your loved one...",1,"mt-1","block","w-full","border-gray-300","rounded-md","shadow-sm","focus:ring-blue-500","focus:border-blue-500"],["for","goal_amount",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","goal_amount","formControlName","goal_amount","min","0","step","0.01","placeholder","0.00",1,"mt-1","block","w-full","border-gray-300","rounded-md","shadow-sm","focus:ring-blue-500","focus:border-blue-500"],[1,"mt-1","text-sm","text-gray-500"],["for","beneficiary_name",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","beneficiary_name","formControlName","beneficiary_name","placeholder","Enter beneficiary full name",1,"mt-1","block","w-full","border-gray-300","rounded-md","shadow-sm","focus:ring-blue-500","focus:border-blue-500"],["for","beneficiary_account_type",1,"block","text-sm","font-medium","text-gray-700"],["id","beneficiary_account_type","formControlName","beneficiary_account_type",1,"mt-1","block","w-full","border-gray-300","rounded-md","shadow-sm","focus:ring-blue-500","focus:border-blue-500",3,"change"],["value","bank"],["value","mobile_money"],[4,"ngIf"],["for","announcement_start_date",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","announcement_start_date","formControlName","announcement_start_date",1,"mt-1","block","w-full","border-gray-300","rounded-md","shadow-sm","focus:ring-blue-500","focus:border-blue-500",3,"min"],["for","announcement_end_date",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","announcement_end_date","formControlName","announcement_end_date",1,"mt-1","block","w-full","border-gray-300","rounded-md","shadow-sm","focus:ring-blue-500","focus:border-blue-500",3,"min"],["class","bg-red-50 border border-red-200 rounded-md p-4",4,"ngIf"],["class","bg-green-50 border border-green-200 rounded-md p-4",4,"ngIf"],[1,"flex","justify-end","space-x-3"],["type","button",1,"py-2","px-4","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],["type","submit",1,"py-2","px-4","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-blue-600","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","disabled:opacity-50",3,"disabled"],["class","flex items-center",4,"ngIf"],[1,"text-red-500","text-sm","mt-1"],["for","beneficiary_bank_account",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","beneficiary_bank_account","formControlName","beneficiary_bank_account","placeholder","Enter account number",1,"mt-1","block","w-full","border-gray-300","rounded-md","shadow-sm","focus:ring-blue-500","focus:border-blue-500"],["for","beneficiary_mobile_money",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","beneficiary_mobile_money","formControlName","beneficiary_mobile_money","placeholder","Enter mobile money number",1,"mt-1","block","w-full","border-gray-300","rounded-md","shadow-sm","focus:ring-blue-500","focus:border-blue-500"],[1,"bg-red-50","border","border-red-200","rounded-md","p-4"],[1,"text-red-600","text-sm"],[1,"bg-green-50","border","border-green-200","rounded-md","p-4"],[1,"text-green-600","text-sm"],[1,"flex","items-center"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(r,n){if(1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),e.EFF(5,"Create Funeral Announcement"),e.k0s(),e.j41(6,"form",5),e.bIt("ngSubmit",function(){return n.onSubmit()}),e.j41(7,"div",6)(8,"h2",7),e.EFF(9,"Deceased Information"),e.k0s(),e.j41(10,"div",8)(11,"div",9)(12,"label",10),e.EFF(13," Name of Deceased * "),e.k0s(),e.nrm(14,"input",11),e.DNE(15,k,2,0,"div",12),e.k0s(),e.j41(16,"div")(17,"label",13),e.EFF(18," Date of Birth "),e.k0s(),e.nrm(19,"input",14),e.k0s(),e.j41(20,"div")(21,"label",15),e.EFF(22," Date of Death "),e.k0s(),e.nrm(23,"input",16),e.k0s(),e.j41(24,"div")(25,"label",17),e.EFF(26," Funeral Date & Time "),e.k0s(),e.nrm(27,"input",18),e.k0s(),e.j41(28,"div")(29,"label",19),e.EFF(30," Ceremony Type "),e.k0s(),e.j41(31,"select",20)(32,"option",21),e.EFF(33,"Burial"),e.k0s(),e.j41(34,"option",22),e.EFF(35,"Cremation"),e.k0s(),e.j41(36,"option",23),e.EFF(37,"Memorial Service"),e.k0s(),e.j41(38,"option",24),e.EFF(39,"Other"),e.k0s()()(),e.j41(40,"div",9)(41,"label",25),e.EFF(42," Funeral Location "),e.k0s(),e.nrm(43,"input",26),e.k0s(),e.j41(44,"div",9)(45,"label",27),e.EFF(46," Family Message * "),e.k0s(),e.nrm(47,"textarea",28),e.DNE(48,F,2,0,"div",12),e.k0s(),e.j41(49,"div")(50,"label",29),e.EFF(51," Goal Amount (USD) "),e.k0s(),e.nrm(52,"input",30),e.j41(53,"p",31),e.EFF(54,"Optional - Set a donation goal"),e.k0s()()()(),e.j41(55,"div",6)(56,"h2",7),e.EFF(57,"Beneficiary Information"),e.k0s(),e.j41(58,"div",8)(59,"div",9)(60,"label",32),e.EFF(61," Beneficiary Name * "),e.k0s(),e.nrm(62,"input",33),e.DNE(63,v,2,0,"div",12),e.k0s(),e.j41(64,"div")(65,"label",34),e.EFF(66," Account Type * "),e.k0s(),e.j41(67,"select",35),e.bIt("change",function(){return n.onAccountTypeChange()}),e.j41(68,"option",36),e.EFF(69,"Bank Account"),e.k0s(),e.j41(70,"option",37),e.EFF(71,"Mobile Money"),e.k0s()()(),e.DNE(72,E,4,0,"div",38)(73,C,4,0,"div",38),e.k0s()(),e.j41(74,"div",6)(75,"h2",7),e.EFF(76,"Announcement Period"),e.k0s(),e.j41(77,"div",8)(78,"div")(79,"label",39),e.EFF(80," Start Date * "),e.k0s(),e.nrm(81,"input",40),e.DNE(82,x,2,0,"div",12),e.k0s(),e.j41(83,"div")(84,"label",41),e.EFF(85," End Date * "),e.k0s(),e.nrm(86,"input",42),e.j41(87,"p",31),e.EFF(88," Announcement will remain open for 5 days after the end date "),e.k0s(),e.DNE(89,w,2,0,"div",12),e.k0s()()(),e.DNE(90,j,3,1,"div",43)(91,D,3,1,"div",44),e.j41(92,"div",45)(93,"button",46),e.bIt("click",function(){return n.cancel()}),e.EFF(94," Cancel "),e.k0s(),e.j41(95,"button",47),e.DNE(96,A,2,0,"span",38)(97,T,5,0,"span",48),e.k0s()()()()()()()),2&r){let m,u,s,b,g,l,y,c;e.R7$(6),e.Y8G("formGroup",n.announcementForm),e.R7$(9),e.Y8G("ngIf",(null==(m=n.announcementForm.get("deceased_name"))?null:m.invalid)&&(null==(m=n.announcementForm.get("deceased_name"))?null:m.touched)),e.R7$(33),e.Y8G("ngIf",(null==(u=n.announcementForm.get("family_message"))?null:u.invalid)&&(null==(u=n.announcementForm.get("family_message"))?null:u.touched)),e.R7$(15),e.Y8G("ngIf",(null==(s=n.announcementForm.get("beneficiary_name"))?null:s.invalid)&&(null==(s=n.announcementForm.get("beneficiary_name"))?null:s.touched)),e.R7$(9),e.Y8G("ngIf","bank"===(null==(b=n.announcementForm.get("beneficiary_account_type"))?null:b.value)),e.R7$(),e.Y8G("ngIf","mobile_money"===(null==(g=n.announcementForm.get("beneficiary_account_type"))?null:g.value)),e.R7$(8),e.Y8G("min",n.today),e.R7$(),e.Y8G("ngIf",(null==(l=n.announcementForm.get("announcement_start_date"))?null:l.invalid)&&(null==(l=n.announcementForm.get("announcement_start_date"))?null:l.touched)),e.R7$(4),e.Y8G("min",(null==(y=n.announcementForm.get("announcement_start_date"))?null:y.value)||n.today),e.R7$(3),e.Y8G("ngIf",(null==(c=n.announcementForm.get("announcement_end_date"))?null:c.invalid)&&(null==(c=n.announcementForm.get("announcement_end_date"))?null:c.touched)),e.R7$(),e.Y8G("ngIf",n.errorMessage),e.R7$(),e.Y8G("ngIf",n.successMessage),e.R7$(4),e.Y8G("disabled",n.announcementForm.invalid||n.isLoading),e.R7$(),e.Y8G("ngIf",!n.isLoading),e.R7$(),e.Y8G("ngIf",n.isLoading)}},dependencies:[f.MD,f.bT,a.YN,a.qT,a.xH,a.y7,a.me,a.Q0,a.wz,a.BC,a.cb,a.VZ,a.X1,a.j4,a.JD],encapsulation:2})}}return o})()}}]);