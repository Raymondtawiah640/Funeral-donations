"use strict";(self.webpackChunklegacy_donation=self.webpackChunklegacy_donation||[]).push([[249],{3249:(I,m,d)=>{d.r(m),d.d(m,{DonateComponent:()=>E});var l=d(177),s=d(4341),e=d(4438),c=d(3366),u=d(6544);function g(t,a){1&t&&(e.j41(0,"div",9),e.qSk(),e.j41(1,"svg",10),e.nrm(2,"circle",11)(3,"path",12),e.k0s(),e.joV(),e.j41(4,"p",13),e.EFF(5,"Loading announcement details..."),e.k0s()())}function f(t,a){if(1&t&&e.nrm(0,"img",23),2&t){const n=e.XpG(2);e.Y8G("src",n.getThumbnailImage(n.announcement),e.B4B)("alt",n.announcement.deceased_name)}}function p(t,a){if(1&t&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&t){const n=e.XpG(2);e.R7$(),e.SpI("Goal: ",n.formatCurrency(n.announcement.goal_amount),"")}}function _(t,a){if(1&t&&(e.j41(0,"div",14)(1,"div",15)(2,"div",16),e.DNE(3,f,1,2,"img",17),e.k0s(),e.j41(4,"div",18)(5,"h2",19),e.EFF(6),e.k0s(),e.j41(7,"p",20),e.EFF(8),e.k0s(),e.j41(9,"div",21),e.DNE(10,p,2,1,"span",22),e.j41(11,"span"),e.EFF(12),e.k0s()()()()()),2&t){const n=e.XpG();e.R7$(3),e.Y8G("ngIf",n.getThumbnailImage(n.announcement)),e.R7$(3),e.JRh(n.announcement.deceased_name),e.R7$(2),e.JRh(n.getMessagePreview()),e.R7$(2),e.Y8G("ngIf",n.announcement.goal_amount),e.R7$(2),e.SpI("Raised: ",n.formatCurrency(n.announcement.total_raised||0),"")}}function h(t,a){1&t&&(e.j41(0,"div",24)(1,"h2",25),e.EFF(2," Make a Donation "),e.k0s(),e.j41(3,"p",26),e.EFF(4," Your contribution helps provide support to families during their most difficult times. "),e.k0s()())}function b(t,a){1&t&&(e.j41(0,"div",27)(1,"div",28)(2,"div",16),e.qSk(),e.j41(3,"svg",29),e.nrm(4,"path",30),e.k0s()(),e.joV(),e.j41(5,"div",31)(6,"h3",32),e.EFF(7," Notification Sent! "),e.k0s(),e.j41(8,"p",33),e.EFF(9," Thank you for notifying the family of your donation. They will appreciate your thoughtfulness! "),e.k0s()()()())}function x(t,a){if(1&t&&(e.j41(0,"div",34)(1,"div",28)(2,"div",16),e.qSk(),e.j41(3,"svg",35),e.nrm(4,"path",36),e.k0s()(),e.joV(),e.j41(5,"div",31)(6,"h3",37),e.EFF(7," Error "),e.k0s(),e.j41(8,"p",38),e.EFF(9),e.k0s()()()()),2&t){const n=e.XpG();e.R7$(9),e.SpI(" ",n.errorMessage," ")}}function v(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",73)(1,"label",58),e.EFF(2,"Bank Account Number"),e.k0s(),e.j41(3,"div",74)(4,"p",75),e.EFF(5),e.k0s(),e.j41(6,"button",76),e.bIt("click",function(){e.eBV(n);const i=e.XpG(3);return e.Njj(i.copyToClipboard(i.announcement.beneficiary_bank_account||""))}),e.qSk(),e.j41(7,"svg",77),e.nrm(8,"path",78),e.k0s()()()()}if(2&t){const n=e.XpG(3);e.R7$(5),e.JRh(n.announcement.beneficiary_bank_account)}}function y(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",73)(1,"label",58),e.EFF(2,"Mobile Money Number"),e.k0s(),e.j41(3,"div",74)(4,"p",75),e.EFF(5),e.k0s(),e.j41(6,"button",76),e.bIt("click",function(){e.eBV(n);const i=e.XpG(3);return e.Njj(i.copyToClipboard(i.announcement.beneficiary_mobile_money||""))}),e.qSk(),e.j41(7,"svg",77),e.nrm(8,"path",78),e.k0s()()()()}if(2&t){const n=e.XpG(3);e.R7$(5),e.JRh(n.announcement.beneficiary_mobile_money)}}function k(t,a){if(1&t&&(e.j41(0,"span",65),e.EFF(1),e.k0s()),2&t){const n=e.XpG(3);e.R7$(),e.SpI("Goal: ",n.formatCurrency(n.announcement.goal_amount),"")}}function F(t,a){if(1&t&&(e.j41(0,"div",53)(1,"h3",54),e.EFF(2,"How to Donate"),e.k0s(),e.j41(3,"p",43),e.EFF(4," Please send your donation directly to the beneficiary's account using the details below. "),e.k0s(),e.j41(5,"div",55)(6,"h4",56),e.EFF(7,"Payment Details"),e.k0s(),e.j41(8,"div",57)(9,"div")(10,"label",58),e.EFF(11,"Beneficiary"),e.k0s(),e.j41(12,"p",59),e.EFF(13),e.k0s()(),e.j41(14,"div")(15,"label",58),e.EFF(16,"Account Type"),e.k0s(),e.j41(17,"p",60),e.EFF(18),e.k0s()(),e.DNE(19,v,9,1,"div",61)(20,y,9,1,"div",61),e.k0s()(),e.j41(21,"div",62)(22,"h4",63),e.EFF(23,"Donation Progress"),e.k0s(),e.j41(24,"div",64)(25,"span",65),e.EFF(26),e.k0s(),e.DNE(27,k,2,1,"span",66),e.k0s(),e.j41(28,"div",67),e.nrm(29,"div",68),e.k0s(),e.j41(30,"p",69),e.EFF(31),e.nI1(32,"number"),e.k0s()(),e.j41(33,"div",70)(34,"h4",71),e.EFF(35,"Thank You"),e.k0s(),e.j41(36,"p",72),e.EFF(37," After making your donation, the family will be notified and the donation amount will be updated on this page. Please keep your transaction receipt for your records. "),e.k0s()()()),2&t){const n=e.XpG(2);e.R7$(13),e.JRh(n.announcement.beneficiary_name),e.R7$(5),e.JRh("bank"===n.announcement.beneficiary_account_type?"Bank Account":"Mobile Money"),e.R7$(),e.Y8G("ngIf","bank"===n.announcement.beneficiary_account_type),e.R7$(),e.Y8G("ngIf","mobile_money"===n.announcement.beneficiary_account_type),e.R7$(6),e.SpI("Raised: ",n.formatCurrency(n.announcement.total_raised||0),""),e.R7$(),e.Y8G("ngIf",n.announcement.goal_amount),e.R7$(2),e.xc7("width",n.getProgressPercentage(),"%"),e.R7$(2),e.SpI("",e.i5U(32,9,n.getProgressPercentage(),"1.0-0"),"% of goal reached")}}function j(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",39),e.DNE(1,F,38,12,"div",40),e.j41(2,"div",41)(3,"h3",42),e.EFF(4,"Notify the Family (Optional)"),e.k0s(),e.j41(5,"p",43),e.EFF(6," Let the family know you've made a donation by filling out the form below. "),e.k0s(),e.j41(7,"form",44,0),e.bIt("ngSubmit",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.onNotifyFamily())}),e.j41(9,"div",45)(10,"div")(11,"label",46),e.EFF(12,"Your Name *"),e.k0s(),e.j41(13,"input",47),e.mxI("ngModelChange",function(i){e.eBV(n);const r=e.XpG();return e.DH7(r.donorInfo.firstName,i)||(r.donorInfo.firstName=i),e.Njj(i)}),e.k0s()(),e.j41(14,"div")(15,"label",46),e.EFF(16,"Email *"),e.k0s(),e.j41(17,"input",48),e.mxI("ngModelChange",function(i){e.eBV(n);const r=e.XpG();return e.DH7(r.donorInfo.email,i)||(r.donorInfo.email=i),e.Njj(i)}),e.k0s()(),e.j41(18,"div",49)(19,"label",46),e.EFF(20,"Message (Optional)"),e.k0s(),e.j41(21,"textarea",50),e.mxI("ngModelChange",function(i){e.eBV(n);const r=e.XpG();return e.DH7(r.donorInfo.phone,i)||(r.donorInfo.phone=i),e.Njj(i)}),e.k0s()()(),e.j41(22,"div",51)(23,"button",52),e.EFF(24),e.k0s()()()()()}if(2&t){const n=e.sdS(8),o=e.XpG();e.R7$(),e.Y8G("ngIf",o.announcement),e.R7$(12),e.R50("ngModel",o.donorInfo.firstName),e.R7$(4),e.R50("ngModel",o.donorInfo.email),e.R7$(4),e.R50("ngModel",o.donorInfo.phone),e.R7$(2),e.Y8G("disabled",!n.valid||o.isSubmitting),e.R7$(),e.SpI(" ",o.isSubmitting?"Sending...":"Send Notification"," ")}}let E=(()=>{class t{constructor(n,o){this.apiService=n,this.route=o,this.title="Donate - Legacy Donation",this.announcement=null,this.announcementId=null,this.donorInfo={firstName:"",email:"",phone:""},this.isSubmitting=!1,this.showSuccessMessage=!1,this.showErrorMessage=!1,this.errorMessage="",this.isLoading=!0}ngOnInit(){this.announcementId=parseInt(this.route.snapshot.paramMap.get("announcementId")||"0"),this.announcementId>0?this.loadAnnouncement(this.announcementId):(this.isLoading=!1,this.showError("Invalid announcement ID"))}loadAnnouncement(n){this.apiService.getAnnouncement(n).subscribe({next:o=>{this.isLoading=!1,o.success?(this.announcement=o.data,"active"!==this.announcement.status&&"grace_period"!==this.announcement.status&&this.showError("This announcement is no longer accepting donations.")):this.showError(o.error||"Failed to load announcement details")},error:o=>{this.isLoading=!1,this.showError(this.apiService.getErrorMessage(o))}})}onNotifyFamily(){this.donorInfo.firstName&&this.donorInfo.email?(this.isSubmitting=!0,this.showSuccessMessage=!1,this.showErrorMessage=!1,setTimeout(()=>{this.isSubmitting=!1,this.showSuccessMessage=!0,this.resetForm(),window.scrollTo({top:0,behavior:"smooth"})},1e3)):this.showError("Please fill in all required fields.")}showError(n){this.errorMessage=n,this.showErrorMessage=!0,this.showSuccessMessage=!1}resetForm(){this.donorInfo={firstName:"",email:"",phone:""}}getThumbnailImage(n){const o=n.files?.find(i=>"deceased_photo"===i.upload_purpose);return o&&"image"===o.file_type?`https://kilnenterprise.com/Donations/api/${o.file_path}`:null}getProgressPercentage(){return this.announcement?.goal_amount&&0!==this.announcement.goal_amount?Math.min((this.announcement.total_raised||0)/this.announcement.goal_amount*100,100):0}formatCurrency(n){return`$${n.toFixed(2)}`}getMessagePreview(){const n=this.announcement?.family_message||"";return n.length>100?n.substring(0,100)+"...":n}copyToClipboard(n){navigator.clipboard&&navigator.clipboard.writeText(n).then(()=>{console.log("Copied to clipboard:",n)})}static{this.\u0275fac=function(o){return new(o||t)(e.rXU(c.G),e.rXU(u.nX))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-donate"]],standalone:!0,features:[e.aNF],decls:8,vars:6,consts:[["notificationForm","ngForm"],[1,"py-20"],[1,"max-w-3xl","mx-auto","px-4","sm:px-6","lg:px-8"],["class","text-center py-12",4,"ngIf"],["class","mb-8 bg-white rounded-lg shadow-md p-6",4,"ngIf"],["class","text-center",4,"ngIf"],["class","mt-8 bg-green-50 border border-green-200 rounded-md p-4",4,"ngIf"],["class","mt-8 bg-red-50 border border-red-200 rounded-md p-4",4,"ngIf"],["class","mt-12 bg-white shadow-lg rounded-lg p-8",4,"ngIf"],[1,"text-center","py-12"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-12","w-12","text-blue-600","mx-auto"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"mt-4","text-gray-600"],[1,"mb-8","bg-white","rounded-lg","shadow-md","p-6"],[1,"flex","items-center","space-x-4"],[1,"flex-shrink-0"],["class","h-16 w-16 object-cover rounded-lg shadow-md",3,"src","alt",4,"ngIf"],[1,"flex-1"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-600"],[1,"mt-2","flex","items-center","space-x-4","text-sm","text-gray-500"],[4,"ngIf"],[1,"h-16","w-16","object-cover","rounded-lg","shadow-md",3,"src","alt"],[1,"text-center"],[1,"text-3xl","font-extrabold","text-gray-900","sm:text-4xl"],[1,"mt-4","text-lg","text-gray-500"],[1,"mt-8","bg-green-50","border","border-green-200","rounded-md","p-4"],[1,"flex"],["viewBox","0 0 20 20","fill","currentColor",1,"h-5","w-5","text-green-400"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule","evenodd"],[1,"ml-3"],[1,"text-sm","font-medium","text-green-800"],[1,"mt-2","text-sm","text-green-700"],[1,"mt-8","bg-red-50","border","border-red-200","rounded-md","p-4"],["viewBox","0 0 20 20","fill","currentColor",1,"h-5","w-5","text-red-400"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule","evenodd"],[1,"text-sm","font-medium","text-red-800"],[1,"mt-2","text-sm","text-red-700"],[1,"mt-12","bg-white","shadow-lg","rounded-lg","p-8"],["class","mb-8",4,"ngIf"],[1,"border-t","border-gray-200","pt-8"],[1,"text-lg","font-medium","text-gray-900","mb-4"],[1,"text-gray-600","mb-6"],[3,"ngSubmit"],[1,"grid","grid-cols-1","gap-6","sm:grid-cols-2"],[1,"block","text-sm","font-medium","text-gray-700"],["type","text","name","donorName","required","",1,"mt-1","focus:ring-blue-500","focus:border-blue-500","block","w-full","shadow-sm","sm:text-sm","border-gray-300","rounded-md",3,"ngModelChange","ngModel"],["type","email","name","donorEmail","required","",1,"mt-1","focus:ring-blue-500","focus:border-blue-500","block","w-full","shadow-sm","sm:text-sm","border-gray-300","rounded-md",3,"ngModelChange","ngModel"],[1,"sm:col-span-2"],["name","donorMessage","rows","3","placeholder","Share a message of support...",1,"mt-1","focus:ring-blue-500","focus:border-blue-500","block","w-full","shadow-sm","sm:text-sm","border-gray-300","rounded-md",3,"ngModelChange","ngModel"],[1,"mt-6"],["type","submit",1,"w-full","sm:w-auto","inline-flex","justify-center","py-2","px-4","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-green-600","hover:bg-green-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-green-500","disabled:opacity-50",3,"disabled"],[1,"mb-8"],[1,"text-lg","font-medium","text-gray-900","mb-6"],[1,"bg-gray-50","rounded-lg","p-6","mb-6"],[1,"text-md","font-medium","text-gray-900","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"block","text-sm","font-medium","text-gray-500"],[1,"mt-1","text-sm","text-gray-900","font-medium"],[1,"mt-1","text-sm","text-gray-900"],["class","md:col-span-2",4,"ngIf"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-6","mb-6"],[1,"text-md","font-medium","text-blue-900","mb-3"],[1,"flex","items-center","justify-between","mb-2"],[1,"text-sm","text-blue-700"],["class","text-sm text-blue-700",4,"ngIf"],[1,"w-full","bg-blue-200","rounded-full","h-3"],[1,"bg-blue-600","h-3","rounded-full","transition-all","duration-300"],[1,"mt-2","text-sm","text-blue-700"],[1,"bg-green-50","border","border-green-200","rounded-lg","p-6"],[1,"text-md","font-medium","text-green-900","mb-2"],[1,"text-sm","text-green-700"],[1,"md:col-span-2"],[1,"flex","items-center","mt-1"],[1,"text-sm","text-gray-900","font-mono","text-lg"],["type","button",1,"ml-3","text-blue-600","hover:text-blue-800",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"]],template:function(o,i){1&o&&(e.j41(0,"div",1)(1,"div",2),e.DNE(2,g,6,0,"div",3)(3,_,13,5,"div",4)(4,h,5,0,"div",5)(5,b,10,0,"div",6)(6,x,10,1,"div",7)(7,j,25,6,"div",8),e.k0s()()),2&o&&(e.R7$(2),e.Y8G("ngIf",i.isLoading),e.R7$(),e.Y8G("ngIf",i.announcement&&!i.isLoading),e.R7$(),e.Y8G("ngIf",!i.isLoading),e.R7$(),e.Y8G("ngIf",i.showSuccessMessage),e.R7$(),e.Y8G("ngIf",i.showErrorMessage),e.R7$(),e.Y8G("ngIf",!i.isLoading))},dependencies:[l.MD,l.bT,l.QX,s.YN,s.qT,s.me,s.BC,s.cb,s.YS,s.vS,s.cV],encapsulation:2})}}return t})()}}]);