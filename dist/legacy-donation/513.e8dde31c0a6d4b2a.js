"use strict";(self.webpackChunklegacy_donation=self.webpackChunklegacy_donation||[]).push([[513],{2513:(L,m,r)=>{r.r(m),r.d(m,{AnnouncementsComponent:()=>w});var a=r(177),u=r(6544),c=r(4341),e=r(4438),g=r(3366);const _=(n,s,t)=>({"bg-green-100 text-green-800":n,"bg-yellow-100 text-yellow-800":s,"bg-red-100 text-red-800":t}),p=n=>["/announcements",n],f=n=>["/donate",n];function h(n,s){1&n&&(e.j41(0,"div",15),e.qSk(),e.j41(1,"svg",16),e.nrm(2,"circle",17)(3,"path",18),e.k0s(),e.joV(),e.j41(4,"p",19),e.EFF(5,"Loading announcements..."),e.k0s()())}function v(n,s){if(1&n&&(e.j41(0,"div",20)(1,"div",21),e.EFF(2),e.k0s()()),2&n){const t=e.XpG();e.R7$(2),e.JRh(t.error)}}function x(n,s){if(1&n&&(e.j41(0,"div")(1,"span",44),e.EFF(2,"Passed:"),e.k0s(),e.j41(3,"span",45),e.EFF(4),e.nI1(5,"date"),e.k0s()()),2&n){const t=e.XpG().$implicit;e.R7$(4),e.JRh(e.i5U(5,1,t.deceased_death_date,"longDate"))}}function k(n,s){if(1&n&&(e.j41(0,"div")(1,"span",44),e.EFF(2,"Funeral:"),e.k0s(),e.j41(3,"span",45),e.EFF(4),e.nI1(5,"date"),e.k0s()()),2&n){const t=e.XpG().$implicit;e.R7$(4),e.JRh(e.i5U(5,1,t.funeral_date,"mediumDate"))}}function b(n,s){if(1&n&&(e.j41(0,"div")(1,"span",44),e.EFF(2,"Location:"),e.k0s(),e.j41(3,"span",45),e.EFF(4),e.k0s()()),2&n){const t=e.XpG().$implicit;e.R7$(4),e.JRh(t.funeral_location)}}function F(n,s){if(1&n&&(e.j41(0,"div")(1,"span",46),e.EFF(2,"Goal:"),e.k0s(),e.j41(3,"span",47),e.EFF(4),e.nI1(5,"number"),e.k0s()()),2&n){const t=e.XpG().$implicit;e.R7$(4),e.SpI("GH\u20b5",e.i5U(5,1,t.goal_amount,"1.2-2"),"")}}function R(n,s){if(1&n&&(e.j41(0,"a",48),e.EFF(1," Donate "),e.k0s()),2&n){const t=e.XpG().$implicit;e.Y8G("routerLink",e.eq3(1,f,t.id))}}function j(n,s){if(1&n&&(e.j41(0,"div",49),e.nrm(1,"img",50),e.k0s()),2&n){const t=e.XpG().$implicit,i=e.XpG(2);e.R7$(),e.Y8G("src",i.getThumbnailImage(t),e.B4B)("alt",t.deceased_name)}}function E(n,s){if(1&n){const t=e.RV6();e.j41(0,"div",24)(1,"div",25)(2,"div",26)(3,"div",27)(4,"div",28)(5,"h2",29),e.EFF(6),e.k0s(),e.j41(7,"span",30),e.EFF(8),e.nI1(9,"titlecase"),e.k0s()(),e.j41(10,"p",31),e.EFF(11),e.k0s(),e.j41(12,"div",32)(13,"button",33),e.bIt("click",function(){const o=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.toggleReaction(o,"like"))}),e.j41(14,"span",34),e.EFF(15,"\u{1f44d}"),e.k0s(),e.j41(16,"span"),e.EFF(17),e.k0s()(),e.j41(18,"button",35),e.bIt("click",function(){const o=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.toggleReaction(o,"love"))}),e.j41(19,"span",34),e.EFF(20,"\u2764\ufe0f"),e.k0s(),e.j41(21,"span"),e.EFF(22),e.k0s()()(),e.j41(23,"div",36),e.DNE(24,x,6,4,"div",37)(25,k,6,4,"div",37)(26,b,5,1,"div",37),e.k0s(),e.j41(27,"div",38)(28,"div",39),e.DNE(29,F,6,4,"div",37),e.k0s(),e.j41(30,"div",40)(31,"a",41),e.EFF(32," View Details "),e.k0s(),e.DNE(33,R,2,3,"a",42),e.k0s()()(),e.DNE(34,j,2,2,"div",43),e.k0s()()()}if(2&n){const t=s.$implicit,i=e.XpG(2);e.R7$(6),e.JRh(t.deceased_name),e.R7$(),e.Y8G("ngClass",e.sMw(23,_,"active"===t.status,"grace_period"===t.status,"closed"===t.status||"expired"===t.status)),e.R7$(),e.SpI(" ",e.bMT(9,21,t.status)," "),e.R7$(3),e.JRh(t.family_message),e.R7$(2),e.AVh("text-blue-600","like"===(null==t.reactions?null:t.reactions.user_reaction))("text-gray-400","like"!==(null==t.reactions?null:t.reactions.user_reaction)),e.R7$(4),e.JRh((null==t.reactions?null:t.reactions.likes)||0),e.R7$(),e.AVh("text-red-600","love"===(null==t.reactions?null:t.reactions.user_reaction))("text-gray-400","love"!==(null==t.reactions?null:t.reactions.user_reaction)),e.R7$(4),e.JRh((null==t.reactions?null:t.reactions.loves)||0),e.R7$(2),e.Y8G("ngIf",t.deceased_death_date),e.R7$(),e.Y8G("ngIf",t.funeral_date),e.R7$(),e.Y8G("ngIf",t.funeral_location),e.R7$(3),e.Y8G("ngIf",t.goal_amount),e.R7$(2),e.Y8G("routerLink",e.eq3(27,p,t.id)),e.R7$(2),e.Y8G("ngIf","active"===t.status||"grace_period"===t.status),e.R7$(),e.Y8G("ngIf",i.getThumbnailImage(t))}}function y(n,s){if(1&n&&(e.j41(0,"div",22),e.DNE(1,E,35,29,"div",23),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.filteredAnnouncements)}}function I(n,s){1&n&&(e.j41(0,"div",15),e.qSk(),e.j41(1,"svg",51),e.nrm(2,"path",10),e.k0s(),e.joV(),e.j41(3,"h3",52),e.EFF(4,"No matching announcements"),e.k0s(),e.j41(5,"p",53),e.EFF(6,"Try adjusting your search terms."),e.k0s()())}function C(n,s){1&n&&(e.j41(0,"div",15),e.qSk(),e.j41(1,"svg",51),e.nrm(2,"path",54),e.k0s(),e.joV(),e.j41(3,"h3",52),e.EFF(4,"No announcements available"),e.k0s(),e.j41(5,"p",53),e.EFF(6,"Be the first to create a funeral announcement."),e.k0s(),e.j41(7,"div",55)(8,"a",56),e.EFF(9," Create Announcement "),e.k0s()()())}function A(n,s){1&n&&(e.j41(0,"div",57)(1,"a",56),e.EFF(2," Create New Announcement "),e.k0s()())}let w=(()=>{class n{constructor(t){this.apiService=t,this.announcements=[],this.searchTerm="",this.isLoading=!0,this.error=""}ngOnInit(){this.loadAnnouncements()}get filteredAnnouncements(){return this.searchTerm?this.announcements.filter(t=>t.deceased_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.announcements}loadAnnouncements(){this.isLoading=!0,this.error="",this.apiService.getAnnouncements().subscribe({next:t=>{this.isLoading=!1,t.success?(this.announcements=t.data,this.apiService.isLoggedIn()||this.loadReactionsFromLocalStorage()):this.error=t.error||"Failed to load announcements"},error:t=>{this.isLoading=!1,this.error=this.apiService.getErrorMessage(t)}})}toggleReaction(t,i){t.reactions||(t.reactions={likes:0,loves:0,user_reaction:null}),t.reactions.user_reaction===i?this.removeReaction(t):this.addReaction(t,i)}addReaction(t,i){this.apiService.isLoggedIn()?this.apiService.addReaction(t.id,i).subscribe({next:o=>{o.success&&this.updateLocalReaction(t,i)},error:o=>{console.error("Failed to add reaction:",o)}}):(this.updateLocalReaction(t,i),this.saveReactionsToLocalStorage())}removeReaction(t){this.apiService.isLoggedIn()?this.apiService.removeReaction(t.id).subscribe({next:i=>{i.success&&this.updateLocalReaction(t,null)},error:i=>{console.error("Failed to remove reaction:",i)}}):(this.updateLocalReaction(t,null),this.saveReactionsToLocalStorage())}updateLocalReaction(t,i){t.reactions||(t.reactions={likes:0,loves:0,user_reaction:null});const o=t.reactions.user_reaction;"like"===o?t.reactions.likes=Math.max(0,t.reactions.likes-1):"love"===o&&(t.reactions.loves=Math.max(0,t.reactions.loves-1)),"like"===i?t.reactions.likes+=1:"love"===i&&(t.reactions.loves+=1),t.reactions.user_reaction=i}saveReactionsToLocalStorage(){const t={};this.announcements.forEach(i=>{void 0!==i.reactions?.user_reaction&&(t[i.id]=i.reactions.user_reaction)}),localStorage.setItem("publicAnnouncementReactions",JSON.stringify(t))}loadReactionsFromLocalStorage(){const t=localStorage.getItem("publicAnnouncementReactions");if(t)try{const i=JSON.parse(t);this.announcements.forEach(o=>{void 0!==i[o.id]&&(o.reactions||(o.reactions={likes:0,loves:0,user_reaction:null}),o.reactions.user_reaction=i[o.id])})}catch(i){console.error("Failed to load reactions from localStorage:",i)}}getThumbnailImage(t){const i=t.files?.find(o=>"deceased_photo"===o.upload_purpose);return i&&"image"===i.file_type?`https://kilnenterprise.com/Donations/${i.file_path}`:null}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(g.G))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-announcements"]],standalone:!0,features:[e.aNF],decls:19,vars:7,consts:[[1,"min-h-screen","bg-gray-50","py-12"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"text-center","mb-8"],[1,"text-3xl","font-bold","text-gray-900"],[1,"mt-2","text-gray-600"],[1,"mt-6","max-w-md","mx-auto"],[1,"relative"],["type","text","placeholder","Search by deceased name...",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","text-gray-900","placeholder-gray-500",3,"ngModelChange","ngModel"],[1,"absolute","inset-y-0","right-0","pr-3","flex","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],["class","text-center py-12",4,"ngIf"],["class","bg-red-50 border border-red-200 rounded-md p-4 mb-8",4,"ngIf"],["class","space-y-6",4,"ngIf"],["class","text-center mt-8",4,"ngIf"],[1,"text-center","py-12"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-12","w-12","text-blue-600","mx-auto"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"mt-4","text-gray-600"],[1,"bg-red-50","border","border-red-200","rounded-md","p-4","mb-8"],[1,"text-red-600","text-sm"],[1,"space-y-6"],["class","bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow",4,"ngFor","ngForOf"],[1,"bg-white","rounded-lg","shadow-md","overflow-hidden","hover:shadow-lg","transition-shadow"],[1,"p-6"],[1,"flex","flex-col","lg:flex-row","lg:items-start"],[1,"flex-1","lg:mr-6"],[1,"flex","items-center","mb-2"],[1,"text-xl","font-semibold","text-gray-900"],[1,"ml-3","inline-flex","items-center","px-3","py-1","rounded-full","text-sm","font-medium",3,"ngClass"],[1,"text-gray-600","mb-4","line-clamp-3"],[1,"flex","items-center","space-x-4","mb-4"],[1,"flex","items-center","space-x-1","hover:text-blue-600","transition-colors","text-sm",3,"click"],[1,"text-lg"],[1,"flex","items-center","space-x-1","hover:text-red-600","transition-colors","text-sm",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-4","text-sm"],[4,"ngIf"],[1,"mt-4","flex","items-center","justify-between"],[1,"flex","items-center","space-x-4"],[1,"flex","items-center","space-x-3"],[1,"text-blue-600","hover:text-blue-800","font-medium",3,"routerLink"],["class","inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",3,"routerLink",4,"ngIf"],["class","mt-4 lg:mt-0 lg:ml-6 flex-shrink-0 mx-auto lg:mx-0",4,"ngIf"],[1,"font-medium","text-gray-500"],[1,"ml-1","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"ml-1","font-medium","text-gray-900"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","text-sm","font-medium","rounded-md","text-white","bg-blue-600","hover:bg-blue-700",3,"routerLink"],[1,"mt-4","lg:mt-0","lg:ml-6","flex-shrink-0","mx-auto","lg:mx-0"],[1,"h-24","w-24","lg:h-32","lg:w-32","object-contain","rounded-lg","shadow-md",3,"src","alt"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-16","w-16","text-gray-400"],[1,"mt-4","text-lg","font-medium","text-gray-900"],[1,"mt-2","text-gray-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2M4 13h2m10-4h.01M16 5h.01"],[1,"mt-6"],["routerLink","/create-announcement",1,"inline-flex","items-center","px-6","py-3","border","border-transparent","text-base","font-medium","rounded-md","text-white","bg-blue-600","hover:bg-blue-700"],[1,"text-center","mt-8"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),e.EFF(4,"Funeral Announcements"),e.k0s(),e.j41(5,"p",4),e.EFF(6,"Support families during their time of need"),e.k0s(),e.j41(7,"div",5)(8,"div",6)(9,"input",7),e.mxI("ngModelChange",function(d){return e.DH7(o.searchTerm,d)||(o.searchTerm=d),d}),e.k0s(),e.j41(10,"div",8),e.qSk(),e.j41(11,"svg",9),e.nrm(12,"path",10),e.k0s()()()()(),e.DNE(13,h,6,0,"div",11)(14,v,3,1,"div",12)(15,y,2,1,"div",13)(16,I,7,0,"div",11)(17,C,10,0,"div",11)(18,A,3,0,"div",14),e.k0s()()),2&i&&(e.R7$(9),e.R50("ngModel",o.searchTerm),e.R7$(4),e.Y8G("ngIf",o.isLoading),e.R7$(),e.Y8G("ngIf",o.error&&!o.isLoading),e.R7$(),e.Y8G("ngIf",!o.isLoading&&o.filteredAnnouncements.length>0),e.R7$(),e.Y8G("ngIf",!o.isLoading&&0===o.filteredAnnouncements.length&&o.announcements.length>0),e.R7$(),e.Y8G("ngIf",!o.isLoading&&0===o.announcements.length),e.R7$(),e.Y8G("ngIf",!o.isLoading&&o.filteredAnnouncements.length>0))},dependencies:[a.MD,a.YU,a.Sq,a.bT,a.QX,a.PV,a.vh,u.iI,u.Wk,c.YN,c.me,c.BC,c.vS],encapsulation:2})}}return n})()}}]);