"use strict";(self.webpackChunklegacy_donation=self.webpackChunklegacy_donation||[]).push([[233],{5233:(w,u,c)=>{c.r(u),c.d(u,{SignupComponent:()=>S});var l=c(177),a=c(4341),e=c(4438),d=c(3366),g=c(6544);function m(t,s){if(1&t&&(e.j41(0,"div",22),e.EFF(1),e.k0s()),2&t){const n=e.XpG(2);e.R7$(),e.SpI(" ",n.errorMessage," ")}}function f(t,s){if(1&t&&(e.j41(0,"div",23),e.EFF(1),e.k0s()),2&t){const n=e.XpG(2);e.R7$(),e.SpI(" ",n.successMessage," ")}}function p(t,s){1&t&&(e.j41(0,"span"),e.EFF(1,"Sign Up"),e.k0s())}function _(t,s){1&t&&(e.j41(0,"span",24),e.qSk(),e.j41(1,"svg",25),e.nrm(2,"circle",26)(3,"path",27),e.k0s(),e.EFF(4," Processing... "),e.k0s())}function h(t,s){if(1&t){const n=e.RV6();e.j41(0,"form",9),e.bIt("ngSubmit",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.onSignup())}),e.j41(1,"div")(2,"label",10),e.EFF(3," Full Name * "),e.k0s(),e.j41(4,"div",11)(5,"input",12),e.mxI("ngModelChange",function(i){e.eBV(n);const r=e.XpG();return e.DH7(r.signupForm.fullName,i)||(r.signupForm.fullName=i),e.Njj(i)}),e.k0s()()(),e.j41(6,"div")(7,"label",13),e.EFF(8," Email Address * "),e.k0s(),e.j41(9,"div",11)(10,"input",14),e.mxI("ngModelChange",function(i){e.eBV(n);const r=e.XpG();return e.DH7(r.signupForm.email,i)||(r.signupForm.email=i),e.Njj(i)}),e.k0s()()(),e.j41(11,"div")(12,"label",15),e.EFF(13," Phone Number "),e.k0s(),e.j41(14,"div",11)(15,"input",16),e.mxI("ngModelChange",function(i){e.eBV(n);const r=e.XpG();return e.DH7(r.signupForm.phone,i)||(r.signupForm.phone=i),e.Njj(i)}),e.k0s()()(),e.DNE(16,m,2,1,"div",17)(17,f,2,1,"div",18),e.j41(18,"div")(19,"button",19),e.DNE(20,p,2,0,"span",20)(21,_,5,0,"span",21),e.k0s()()()}if(2&t){const n=e.XpG();e.R7$(5),e.R50("ngModel",n.signupForm.fullName),e.R7$(5),e.R50("ngModel",n.signupForm.email),e.R7$(5),e.R50("ngModel",n.signupForm.phone),e.R7$(),e.Y8G("ngIf",n.errorMessage),e.R7$(),e.Y8G("ngIf",n.successMessage),e.R7$(2),e.Y8G("disabled",n.isLoading),e.R7$(),e.Y8G("ngIf",!n.isLoading),e.R7$(),e.Y8G("ngIf",n.isLoading)}}function x(t,s){if(1&t&&(e.j41(0,"div",22),e.EFF(1),e.k0s()),2&t){const n=e.XpG(2);e.R7$(),e.SpI(" ",n.errorMessage," ")}}function b(t,s){if(1&t&&(e.j41(0,"div",23),e.EFF(1),e.k0s()),2&t){const n=e.XpG(2);e.R7$(),e.SpI(" ",n.successMessage," ")}}function v(t,s){1&t&&(e.j41(0,"span"),e.EFF(1,"Verify Email"),e.k0s())}function y(t,s){1&t&&(e.j41(0,"span",24),e.qSk(),e.j41(1,"svg",25),e.nrm(2,"circle",26)(3,"path",27),e.k0s(),e.EFF(4," Verifying... "),e.k0s())}function C(t,s){if(1&t&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&t){const n=e.XpG(2);e.R7$(),e.SpI("Resend in ",n.countdown,"s")}}function F(t,s){1&t&&(e.j41(0,"span"),e.EFF(1,"Resend Code"),e.k0s())}function j(t,s){if(1&t){const n=e.RV6();e.j41(0,"form",9),e.bIt("ngSubmit",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.onVerifyEmail())}),e.j41(1,"div")(2,"h3",28),e.EFF(3,"Verify Your Email"),e.k0s(),e.j41(4,"p",29),e.EFF(5),e.k0s()(),e.j41(6,"div")(7,"label",30),e.EFF(8," Verification Code * "),e.k0s(),e.j41(9,"div",11)(10,"input",31),e.mxI("ngModelChange",function(i){e.eBV(n);const r=e.XpG();return e.DH7(r.verificationCode,i)||(r.verificationCode=i),e.Njj(i)}),e.k0s()()(),e.DNE(11,x,2,1,"div",17)(12,b,2,1,"div",18),e.j41(13,"div",32)(14,"button",19),e.DNE(15,v,2,0,"span",20)(16,y,5,0,"span",21),e.k0s(),e.j41(17,"button",33),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.resendVerificationCode())}),e.DNE(18,C,2,1,"span",20)(19,F,2,0,"span",20),e.k0s()()()}if(2&t){const n=e.XpG();e.R7$(5),e.SpI(" We've sent a 6-digit verification code to ",n.signupForm.email," "),e.R7$(5),e.R50("ngModel",n.verificationCode),e.R7$(),e.Y8G("ngIf",n.errorMessage),e.R7$(),e.Y8G("ngIf",n.successMessage),e.R7$(2),e.Y8G("disabled",n.isLoading||6!==n.verificationCode.length),e.R7$(),e.Y8G("ngIf",!n.isLoading),e.R7$(),e.Y8G("ngIf",n.isLoading),e.R7$(),e.Y8G("disabled",n.isLoading||n.countdown>0),e.R7$(),e.Y8G("ngIf",n.countdown>0),e.R7$(),e.Y8G("ngIf",0===n.countdown)}}function k(t,s){if(1&t){const n=e.RV6();e.j41(0,"div",34)(1,"div",35),e.qSk(),e.j41(2,"svg",36),e.nrm(3,"path",37),e.k0s()(),e.joV(),e.j41(4,"h3",38),e.EFF(5,"Account created successfully!"),e.k0s(),e.j41(6,"p",39),e.EFF(7," Your account has been verified. You can now log in to create funeral announcements. "),e.k0s(),e.j41(8,"div",40)(9,"button",41),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.goToLogin())}),e.EFF(10," Go to Login "),e.k0s()()()}}function M(t,s){if(1&t){const n=e.RV6();e.j41(0,"div",40)(1,"div",42)(2,"div",43),e.nrm(3,"div",44),e.k0s(),e.j41(4,"div",45)(5,"span",46),e.EFF(6,"Already have an account?"),e.k0s()()(),e.j41(7,"div",40)(8,"button",47),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.goToLogin())}),e.EFF(9," Log In "),e.k0s()()()}}let S=(()=>{class t{constructor(n,o){this.apiService=n,this.router=o,this.currentStep="signup",this.signupForm={fullName:"",email:"",phone:""},this.verificationCode="",this.isLoading=!1,this.errorMessage="",this.successMessage="",this.countdown=0}onSignup(){if(this.errorMessage="",this.successMessage="",this.isLoading=!0,!this.signupForm.fullName||!this.signupForm.email)return this.errorMessage="Please fill in all required fields",void(this.isLoading=!1);this.apiService.signup(this.signupForm.email,this.signupForm.fullName,this.signupForm.phone||void 0).subscribe({next:n=>{this.isLoading=!1,n.success?(this.successMessage=n.data?.verification_code?`Verification code: ${n.data.verification_code} (Check your email or use this code)`:"Verification code sent to your email",this.currentStep="verify",this.startCountdown()):this.errorMessage=n.error||"Failed to create account"},error:n=>{this.isLoading=!1,this.errorMessage=this.apiService.getErrorMessage(n)}})}onVerifyEmail(){6===this.verificationCode.length?(this.errorMessage="",this.successMessage="",this.isLoading=!0,this.apiService.verifyEmail(this.signupForm.email,this.verificationCode).subscribe({next:n=>{this.isLoading=!1,n.success?(this.currentStep="success",this.clearCountdown()):this.errorMessage=n.error||"Verification failed"},error:n=>{this.isLoading=!1,this.errorMessage=this.apiService.getErrorMessage(n)}})):this.errorMessage="Please enter a 6-digit verification code"}resendVerificationCode(){this.countdown>0||(this.isLoading=!0,this.apiService.resendVerificationCode(this.signupForm.email).subscribe({next:n=>{this.isLoading=!1,n.success?(this.successMessage="New verification code sent",this.startCountdown()):this.errorMessage=n.error||"Failed to resend verification code"},error:n=>{this.isLoading=!1,this.errorMessage=this.apiService.getErrorMessage(n)}}))}startCountdown(){this.countdown=60,this.countdownTimer=setInterval(()=>{this.countdown--,this.countdown<=0&&this.clearCountdown()},1e3)}clearCountdown(){this.countdownTimer&&(clearInterval(this.countdownTimer),this.countdownTimer=void 0),this.countdown=0}goToLogin(){this.router.navigate(["/login"])}ngOnDestroy(){this.clearCountdown()}static{this.\u0275fac=function(o){return new(o||t)(e.rXU(d.G),e.rXU(g.Ix))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-signup"]],standalone:!0,features:[e.aNF],decls:12,vars:4,consts:[[1,"min-h-screen","bg-gray-50","flex","flex-col","justify-center","py-12","sm:px-6","lg:px-8"],[1,"sm:mx-auto","sm:w-full","sm:max-w-md"],[1,"mt-6","text-center","text-3xl","font-extrabold","text-gray-900"],[1,"mt-2","text-center","text-sm","text-gray-600"],[1,"mt-8","sm:mx-auto","sm:w-full","sm:max-w-md"],[1,"bg-white","py-8","px-4","shadow","sm:rounded-lg","sm:px-10"],["class","space-y-6",3,"ngSubmit",4,"ngIf"],["class","text-center",4,"ngIf"],["class","mt-6",4,"ngIf"],[1,"space-y-6",3,"ngSubmit"],["for","fullName",1,"block","text-sm","font-medium","text-gray-700"],[1,"mt-1"],["id","fullName","name","fullName","type","text","required","","placeholder","Enter your full name",1,"appearance-none","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","placeholder-gray-400","focus:outline-none","focus:ring-blue-500","focus:border-blue-500",3,"ngModelChange","ngModel"],["for","email",1,"block","text-sm","font-medium","text-gray-700"],["id","email","name","email","type","email","required","","placeholder","Enter your email address",1,"appearance-none","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","placeholder-gray-400","focus:outline-none","focus:ring-blue-500","focus:border-blue-500",3,"ngModelChange","ngModel"],["for","phone",1,"block","text-sm","font-medium","text-gray-700"],["id","phone","name","phone","type","tel","placeholder","Enter your phone number (optional)",1,"appearance-none","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","placeholder-gray-400","focus:outline-none","focus:ring-blue-500","focus:border-blue-500",3,"ngModelChange","ngModel"],["class","text-red-600 text-sm",4,"ngIf"],["class","text-green-600 text-sm",4,"ngIf"],["type","submit",1,"w-full","flex","justify-center","py-2","px-4","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-blue-600","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","disabled:opacity-50",3,"disabled"],[4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"text-red-600","text-sm"],[1,"text-green-600","text-sm"],[1,"flex","items-center"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"text-lg","font-medium","text-gray-900"],[1,"mt-2","text-sm","text-gray-600"],["for","verificationCode",1,"block","text-sm","font-medium","text-gray-700"],["id","verificationCode","name","verificationCode","type","text","maxlength","6","required","","placeholder","000000",1,"appearance-none","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","placeholder-gray-400","focus:outline-none","focus:ring-blue-500","focus:border-blue-500","text-center","text-2xl","tracking-widest",3,"ngModelChange","ngModel"],[1,"space-y-3"],["type","button",1,"w-full","flex","justify-center","py-2","px-4","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","disabled:opacity-50",3,"click","disabled"],[1,"text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-green-100"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[1,"mt-6"],[1,"w-full","flex","justify-center","py-2","px-4","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-blue-600","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],[1,"relative"],[1,"absolute","inset-0","flex","items-center"],[1,"w-full","border-t","border-gray-300"],[1,"relative","flex","justify-center","text-sm"],[1,"px-2","bg-white","text-gray-500"],[1,"w-full","flex","justify-center","py-2","px-4","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"]],template:function(o,i){1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"h2",2),e.EFF(3," Create your account "),e.k0s(),e.j41(4,"p",3),e.EFF(5," Sign up with your email to start creating funeral announcements "),e.k0s()(),e.j41(6,"div",4)(7,"div",5),e.DNE(8,h,22,8,"form",6)(9,j,20,10,"form",6)(10,k,11,0,"div",7)(11,M,10,0,"div",8),e.k0s()()()),2&o&&(e.R7$(8),e.Y8G("ngIf","signup"===i.currentStep),e.R7$(),e.Y8G("ngIf","verify"===i.currentStep),e.R7$(),e.Y8G("ngIf","success"===i.currentStep),e.R7$(),e.Y8G("ngIf","signup"===i.currentStep))},dependencies:[l.MD,l.bT,a.YN,a.qT,a.me,a.BC,a.cb,a.YS,a.tU,a.vS,a.cV],encapsulation:2})}}return t})()}}]);