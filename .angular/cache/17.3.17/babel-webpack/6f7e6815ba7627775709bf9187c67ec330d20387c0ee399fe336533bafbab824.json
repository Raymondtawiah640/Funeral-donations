{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/api.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction LoginComponent_form_8_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 23);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.errorMessage, \" \");\n  }\n}\nfunction LoginComponent_form_8_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 24);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.successMessage, \" \");\n  }\n}\nfunction LoginComponent_form_8_span_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Request Login Code\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginComponent_form_8_span_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 25);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(1, \"svg\", 26);\n    i0.ɵɵelement(2, \"circle\", 27)(3, \"path\", 28);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4, \" Sending... \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginComponent_form_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"form\", 14);\n    i0.ɵɵlistener(\"ngSubmit\", function LoginComponent_form_8_Template_form_ngSubmit_0_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.onRequestLoginCode());\n    });\n    i0.ɵɵelementStart(1, \"div\")(2, \"label\", 15);\n    i0.ɵɵtext(3, \" Email Address * \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 16)(5, \"input\", 17);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function LoginComponent_form_8_Template_input_ngModelChange_5_listener($event) {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r1.loginForm.email, $event) || (ctx_r1.loginForm.email = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(6, LoginComponent_form_8_div_6_Template, 2, 1, \"div\", 18)(7, LoginComponent_form_8_div_7_Template, 2, 1, \"div\", 19);\n    i0.ɵɵelementStart(8, \"div\")(9, \"button\", 20);\n    i0.ɵɵtemplate(10, LoginComponent_form_8_span_10_Template, 2, 0, \"span\", 21)(11, LoginComponent_form_8_span_11_Template, 5, 0, \"span\", 22);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r1.loginForm.email);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.errorMessage);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.successMessage);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r1.isLoading || !ctx_r1.loginForm.email);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.isLoading);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.isLoading);\n  }\n}\nfunction LoginComponent_form_9_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 23);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.errorMessage, \" \");\n  }\n}\nfunction LoginComponent_form_9_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 24);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.successMessage, \" \");\n  }\n}\nfunction LoginComponent_form_9_span_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Sign In\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginComponent_form_9_span_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 25);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(1, \"svg\", 26);\n    i0.ɵɵelement(2, \"circle\", 27)(3, \"path\", 28);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4, \" Signing in... \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginComponent_form_9_span_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\"Send new code in \", ctx_r1.countdown, \"s\");\n  }\n}\nfunction LoginComponent_form_9_span_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Send New Code\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginComponent_form_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"form\", 14);\n    i0.ɵɵlistener(\"ngSubmit\", function LoginComponent_form_9_Template_form_ngSubmit_0_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.onLogin());\n    });\n    i0.ɵɵelementStart(1, \"div\")(2, \"h3\", 29);\n    i0.ɵɵtext(3, \"Enter Login Code\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\", 30);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\")(7, \"label\", 31);\n    i0.ɵɵtext(8, \" Login Code * \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\", 16)(10, \"input\", 32);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function LoginComponent_form_9_Template_input_ngModelChange_10_listener($event) {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r1.loginCode, $event) || (ctx_r1.loginCode = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(11, LoginComponent_form_9_div_11_Template, 2, 1, \"div\", 18)(12, LoginComponent_form_9_div_12_Template, 2, 1, \"div\", 19);\n    i0.ɵɵelementStart(13, \"div\", 33)(14, \"button\", 20);\n    i0.ɵɵtemplate(15, LoginComponent_form_9_span_15_Template, 2, 0, \"span\", 21)(16, LoginComponent_form_9_span_16_Template, 5, 0, \"span\", 22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"button\", 34);\n    i0.ɵɵlistener(\"click\", function LoginComponent_form_9_Template_button_click_17_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.onRequestLoginCode());\n    });\n    i0.ɵɵtemplate(18, LoginComponent_form_9_span_18_Template, 2, 1, \"span\", 21)(19, LoginComponent_form_9_span_19_Template, 2, 0, \"span\", 21);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\" We've sent a 6-digit login code to \", ctx_r1.loginForm.email, \" \");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r1.loginCode);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.errorMessage);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.successMessage);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r1.isLoading || ctx_r1.loginCode.length !== 6);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.isLoading);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.isLoading);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"disabled\", ctx_r1.isLoading || ctx_r1.countdown > 0);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.countdown > 0);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.countdown === 0);\n  }\n}\nexport let LoginComponent = /*#__PURE__*/(() => {\n  class LoginComponent {\n    constructor(apiService, router) {\n      this.apiService = apiService;\n      this.router = router;\n      this.currentStep = 'email';\n      this.loginForm = {\n        email: ''\n      };\n      this.loginCode = '';\n      this.isLoading = false;\n      this.errorMessage = '';\n      this.successMessage = '';\n      this.countdown = 0;\n    }\n    onRequestLoginCode() {\n      this.errorMessage = '';\n      this.successMessage = '';\n      this.isLoading = true;\n      if (!this.loginForm.email) {\n        this.errorMessage = 'Please enter your email address';\n        this.isLoading = false;\n        return;\n      }\n      this.apiService.requestLoginCode(this.loginForm.email).subscribe({\n        next: response => {\n          this.isLoading = false;\n          if (response.success) {\n            // Show login code if available in response\n            if (response.data?.login_code) {\n              this.successMessage = `Login code: ${response.data.login_code} (Check your email or use this code)`;\n            } else {\n              this.successMessage = 'Login code sent to your email';\n            }\n            this.currentStep = 'code';\n            this.startCountdown();\n          } else {\n            this.errorMessage = response.error || 'Failed to send login code';\n          }\n        },\n        error: error => {\n          this.isLoading = false;\n          this.errorMessage = this.apiService.getErrorMessage(error);\n        }\n      });\n    }\n    onLogin() {\n      if (this.loginCode.length !== 6) {\n        this.errorMessage = 'Please enter a 6-digit login code';\n        return;\n      }\n      this.errorMessage = '';\n      this.successMessage = '';\n      this.isLoading = true;\n      this.apiService.loginWithCode(this.loginForm.email, this.loginCode).subscribe({\n        next: response => {\n          this.isLoading = false;\n          if (response.success) {\n            // Set user and token\n            this.apiService.setCurrentUser(response.data.user);\n            this.apiService.setAuthToken(response.data.session_token);\n            // Clear countdown\n            this.clearCountdown();\n            // Navigate to dashboard or announcements\n            this.router.navigate(['/announcements']);\n          } else {\n            this.errorMessage = response.error || 'Login failed';\n          }\n        },\n        error: error => {\n          this.isLoading = false;\n          this.errorMessage = this.apiService.getErrorMessage(error);\n        }\n      });\n    }\n    startCountdown() {\n      this.countdown = 60;\n      this.countdownTimer = setInterval(() => {\n        this.countdown--;\n        if (this.countdown <= 0) {\n          this.clearCountdown();\n        }\n      }, 1000);\n    }\n    clearCountdown() {\n      if (this.countdownTimer) {\n        clearInterval(this.countdownTimer);\n        this.countdownTimer = undefined;\n      }\n      this.countdown = 0;\n    }\n    goToSignup() {\n      this.router.navigate(['/signup']);\n    }\n    ngOnDestroy() {\n      this.clearCountdown();\n    }\n    static {\n      this.ɵfac = function LoginComponent_Factory(t) {\n        return new (t || LoginComponent)(i0.ɵɵdirectiveInject(i1.ApiService), i0.ɵɵdirectiveInject(i2.Router));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: LoginComponent,\n        selectors: [[\"app-login\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 20,\n        vars: 2,\n        consts: [[1, \"min-h-screen\", \"bg-gray-50\", \"flex\", \"flex-col\", \"justify-center\", \"py-12\", \"sm:px-6\", \"lg:px-8\"], [1, \"sm:mx-auto\", \"sm:w-full\", \"sm:max-w-md\"], [1, \"mt-6\", \"text-center\", \"text-3xl\", \"font-extrabold\", \"text-gray-900\"], [1, \"mt-2\", \"text-center\", \"text-sm\", \"text-gray-600\"], [1, \"mt-8\", \"sm:mx-auto\", \"sm:w-full\", \"sm:max-w-md\"], [1, \"bg-white\", \"py-8\", \"px-4\", \"shadow\", \"sm:rounded-lg\", \"sm:px-10\"], [\"class\", \"space-y-6\", 3, \"ngSubmit\", 4, \"ngIf\"], [1, \"mt-6\"], [1, \"relative\"], [1, \"absolute\", \"inset-0\", \"flex\", \"items-center\"], [1, \"w-full\", \"border-t\", \"border-gray-300\"], [1, \"relative\", \"flex\", \"justify-center\", \"text-sm\"], [1, \"px-2\", \"bg-white\", \"text-gray-500\"], [1, \"w-full\", \"flex\", \"justify-center\", \"py-2\", \"px-4\", \"border\", \"border-gray-300\", \"rounded-md\", \"shadow-sm\", \"text-sm\", \"font-medium\", \"text-gray-700\", \"bg-white\", \"hover:bg-gray-50\", \"focus:outline-none\", \"focus:ring-2\", \"focus:ring-offset-2\", \"focus:ring-blue-500\", 3, \"click\"], [1, \"space-y-6\", 3, \"ngSubmit\"], [\"for\", \"email\", 1, \"block\", \"text-sm\", \"font-medium\", \"text-gray-700\"], [1, \"mt-1\"], [\"id\", \"email\", \"name\", \"email\", \"type\", \"email\", \"required\", \"\", \"placeholder\", \"Enter your email address\", 1, \"appearance-none\", \"block\", \"w-full\", \"px-3\", \"py-2\", \"border\", \"border-gray-300\", \"rounded-md\", \"placeholder-gray-400\", \"focus:outline-none\", \"focus:ring-blue-500\", \"focus:border-blue-500\", 3, \"ngModelChange\", \"ngModel\"], [\"class\", \"text-red-600 text-sm\", 4, \"ngIf\"], [\"class\", \"text-green-600 text-sm\", 4, \"ngIf\"], [\"type\", \"submit\", 1, \"w-full\", \"flex\", \"justify-center\", \"py-2\", \"px-4\", \"border\", \"border-transparent\", \"rounded-md\", \"shadow-sm\", \"text-sm\", \"font-medium\", \"text-white\", \"bg-blue-600\", \"hover:bg-blue-700\", \"focus:outline-none\", \"focus:ring-2\", \"focus:ring-offset-2\", \"focus:ring-blue-500\", \"disabled:opacity-50\", 3, \"disabled\"], [4, \"ngIf\"], [\"class\", \"flex items-center\", 4, \"ngIf\"], [1, \"text-red-600\", \"text-sm\"], [1, \"text-green-600\", \"text-sm\"], [1, \"flex\", \"items-center\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"fill\", \"none\", \"viewBox\", \"0 0 24 24\", 1, \"animate-spin\", \"-ml-1\", \"mr-3\", \"h-5\", \"w-5\", \"text-white\"], [\"cx\", \"12\", \"cy\", \"12\", \"r\", \"10\", \"stroke\", \"currentColor\", \"stroke-width\", \"4\", 1, \"opacity-25\"], [\"fill\", \"currentColor\", \"d\", \"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\", 1, \"opacity-75\"], [1, \"text-lg\", \"font-medium\", \"text-gray-900\"], [1, \"mt-2\", \"text-sm\", \"text-gray-600\"], [\"for\", \"loginCode\", 1, \"block\", \"text-sm\", \"font-medium\", \"text-gray-700\"], [\"id\", \"loginCode\", \"name\", \"loginCode\", \"type\", \"text\", \"maxlength\", \"6\", \"required\", \"\", \"placeholder\", \"000000\", 1, \"appearance-none\", \"block\", \"w-full\", \"px-3\", \"py-2\", \"border\", \"border-gray-300\", \"rounded-md\", \"placeholder-gray-400\", \"focus:outline-none\", \"focus:ring-blue-500\", \"focus:border-blue-500\", \"text-center\", \"text-2xl\", \"tracking-widest\", 3, \"ngModelChange\", \"ngModel\"], [1, \"space-y-3\"], [\"type\", \"button\", 1, \"w-full\", \"flex\", \"justify-center\", \"py-2\", \"px-4\", \"border\", \"border-gray-300\", \"rounded-md\", \"shadow-sm\", \"text-sm\", \"font-medium\", \"text-gray-700\", \"bg-white\", \"hover:bg-gray-50\", \"focus:outline-none\", \"focus:ring-2\", \"focus:ring-offset-2\", \"focus:ring-blue-500\", \"disabled:opacity-50\", 3, \"click\", \"disabled\"]],\n        template: function LoginComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h2\", 2);\n            i0.ɵɵtext(3, \" Sign in to your account \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(4, \"p\", 3);\n            i0.ɵɵtext(5, \" Use email verification to access your account \");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(6, \"div\", 4)(7, \"div\", 5);\n            i0.ɵɵtemplate(8, LoginComponent_form_8_Template, 12, 6, \"form\", 6)(9, LoginComponent_form_9_Template, 20, 10, \"form\", 6);\n            i0.ɵɵelementStart(10, \"div\", 7)(11, \"div\", 8)(12, \"div\", 9);\n            i0.ɵɵelement(13, \"div\", 10);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(14, \"div\", 11)(15, \"span\", 12);\n            i0.ɵɵtext(16, \"Don't have an account?\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(17, \"div\", 7)(18, \"button\", 13);\n            i0.ɵɵlistener(\"click\", function LoginComponent_Template_button_click_18_listener() {\n              return ctx.goToSignup();\n            });\n            i0.ɵɵtext(19, \" Create Account \");\n            i0.ɵɵelementEnd()()()()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(8);\n            i0.ɵɵproperty(\"ngIf\", ctx.currentStep === \"email\");\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.currentStep === \"code\");\n          }\n        },\n        dependencies: [CommonModule, i3.NgIf, FormsModule, i4.ɵNgNoValidate, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.RequiredValidator, i4.MaxLengthValidator, i4.NgModel, i4.NgForm],\n        encapsulation: 2\n      });\n    }\n  }\n  return LoginComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}