{"ast":null,"code":"import { HttpHeaders } from '@angular/common/http';\nimport { throwError } from 'rxjs';\nimport { catchError, retry } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class ApiService {\n  constructor(http) {\n    this.http = http;\n    this.baseUrl = 'http://localhost:5000/api';\n  }\n  /**\n   * Test API health and database connection\n   */\n  checkHealth() {\n    return this.http.get(`${this.baseUrl}/health`).pipe(retry(2), catchError(this.handleError));\n  }\n  /**\n   * Get donation statistics\n   */\n  getStatistics() {\n    return this.http.get(`${this.baseUrl}/statistics`).pipe(retry(2), catchError(this.handleError));\n  }\n  /**\n   * Get all donations (for admin purposes)\n   */\n  getDonations() {\n    return this.http.get(`${this.baseUrl}/donations`).pipe(retry(2), catchError(this.handleError));\n  }\n  /**\n   * Create a new donation\n   */\n  createDonation(donation) {\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json'\n    });\n    return this.http.post(`${this.baseUrl}/donations`, donation, {\n      headers\n    }).pipe(catchError(this.handleError));\n  }\n  /**\n   * Submit contact form\n   */\n  submitContactForm(message) {\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json'\n    });\n    return this.http.post(`${this.baseUrl}/contact`, message, {\n      headers\n    }).pipe(catchError(this.handleError));\n  }\n  /**\n   * Handle HTTP errors\n   */\n  handleError(error) {\n    let errorMessage = 'An error occurred';\n    if (error.error instanceof ErrorEvent) {\n      // Client-side error\n      errorMessage = `Error: ${error.error.message}`;\n    } else {\n      // Server-side error\n      if (error.error && error.error.message) {\n        errorMessage = error.error.message;\n      } else if (error.message) {\n        errorMessage = error.message;\n      } else {\n        errorMessage = `Error Code: ${error.status}\\nMessage: ${error.message}`;\n      }\n    }\n    console.error('API Error:', errorMessage);\n    return throwError(() => new Error(errorMessage));\n  }\n  /**\n   * Format error message for user display\n   */\n  getErrorMessage(error) {\n    if (typeof error === 'string') {\n      return error;\n    }\n    if (error && error.message) {\n      return error.message;\n    }\n    return 'An unexpected error occurred. Please try again.';\n  }\n  static {\n    this.ɵfac = function ApiService_Factory(t) {\n      return new (t || ApiService)(i0.ɵɵinject(i1.HttpClient));\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: ApiService,\n      factory: ApiService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["HttpHeaders","throwError","catchError","retry","ApiService","constructor","http","baseUrl","checkHealth","get","pipe","handleError","getStatistics","getDonations","createDonation","donation","headers","post","submitContactForm","message","error","errorMessage","ErrorEvent","status","console","Error","getErrorMessage","i0","ɵɵinject","i1","HttpClient","factory","ɵfac","providedIn"],"sources":["C:\\Users\\THIS PC\\OneDrive\\Desktop\\Funeral donations\\src\\app\\services\\api.service.ts"],"sourcesContent":["/**\n * API Service for Legacy Donation\n * Handles all HTTP communication with the Flask backend\n */\n\nimport { Injectable } from '@angular/core';\nimport { HttpClient, HttpErrorResponse, HttpHeaders } from '@angular/common/http';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, retry } from 'rxjs/operators';\n\nexport interface ApiResponse<T = any> {\n  success: boolean;\n  message?: string;\n  data?: T;\n  count?: number;\n}\n\nexport interface Donation {\n  id?: number;\n  amount: number;\n  donor_name: string;\n  donor_email: string;\n  donor_phone?: string;\n  donation_type: 'one-time' | 'monthly';\n  status?: 'pending' | 'completed' | 'failed';\n  created_at?: string;\n}\n\nexport interface ContactMessage {\n  id?: number;\n  name: string;\n  email: string;\n  phone?: string;\n  subject: string;\n  message: string;\n  status?: 'new' | 'read' | 'responded';\n  created_at?: string;\n}\n\nexport interface Statistics {\n  total_donations: number;\n  total_amount: number;\n  recent_donations: Donation[];\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ApiService {\n  private readonly baseUrl = 'http://localhost:5000/api';\n\n  constructor(private http: HttpClient) {}\n\n  /**\n   * Test API health and database connection\n   */\n  checkHealth(): Observable<ApiResponse> {\n    return this.http.get<ApiResponse>(`${this.baseUrl}/health`)\n      .pipe(\n        retry(2),\n        catchError(this.handleError)\n      );\n  }\n\n  /**\n   * Get donation statistics\n   */\n  getStatistics(): Observable<ApiResponse<Statistics>> {\n    return this.http.get<ApiResponse<Statistics>>(`${this.baseUrl}/statistics`)\n      .pipe(\n        retry(2),\n        catchError(this.handleError)\n      );\n  }\n\n  /**\n   * Get all donations (for admin purposes)\n   */\n  getDonations(): Observable<ApiResponse<Donation[]>> {\n    return this.http.get<ApiResponse<Donation[]>>(`${this.baseUrl}/donations`)\n      .pipe(\n        retry(2),\n        catchError(this.handleError)\n      );\n  }\n\n  /**\n   * Create a new donation\n   */\n  createDonation(donation: Omit<Donation, 'id' | 'status' | 'created_at'>): Observable<ApiResponse> {\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json'\n    });\n\n    return this.http.post<ApiResponse>(`${this.baseUrl}/donations`, donation, { headers })\n      .pipe(\n        catchError(this.handleError)\n      );\n  }\n\n  /**\n   * Submit contact form\n   */\n  submitContactForm(message: Omit<ContactMessage, 'id' | 'status' | 'created_at'>): Observable<ApiResponse> {\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json'\n    });\n\n    return this.http.post<ApiResponse>(`${this.baseUrl}/contact`, message, { headers })\n      .pipe(\n        catchError(this.handleError)\n      );\n  }\n\n  /**\n   * Handle HTTP errors\n   */\n  private handleError(error: HttpErrorResponse): Observable<never> {\n    let errorMessage = 'An error occurred';\n\n    if (error.error instanceof ErrorEvent) {\n      // Client-side error\n      errorMessage = `Error: ${error.error.message}`;\n    } else {\n      // Server-side error\n      if (error.error && error.error.message) {\n        errorMessage = error.error.message;\n      } else if (error.message) {\n        errorMessage = error.message;\n      } else {\n        errorMessage = `Error Code: ${error.status}\\nMessage: ${error.message}`;\n      }\n    }\n\n    console.error('API Error:', errorMessage);\n    return throwError(() => new Error(errorMessage));\n  }\n\n  /**\n   * Format error message for user display\n   */\n  getErrorMessage(error: any): string {\n    if (typeof error === 'string') {\n      return error;\n    }\n    if (error && error.message) {\n      return error.message;\n    }\n    return 'An unexpected error occurred. Please try again.';\n  }\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}